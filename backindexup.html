<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Old Laurentian RFC - Est. 1919</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/responsive.css">
    <script src="js/color-manager.js"></script>
    <link rel="stylesheet" href="css/calendar-widget.css">
    <style>
        /* Admin controlled elements */
        html, body {
            width: 100%;
            max-width: 100%;
            overflow-x: hidden;
        }
        
        body {
            padding-top: 75px; /* Mobile: smaller header */
            padding-left: 0 !important; /* üéØ OLS 111: Remove side padding */
            padding-right: 0 !important; /* üéØ OLS 111: Remove side padding */
            margin-left: 0 !important;
            margin-right: 0 !important;
        }
        
        /* üéØ OLS 111: Ensure footer goes full-width */
        #footer-placeholder,
        .footer {
            margin-left: 0 !important;
            margin-right: 0 !important;
            width: 100% !important;
            max-width: 100% !important;
        }
        
        /* Desktop: taller header needs more clearance */
        @media (min-width: 769px) {
            body {
                padding-top: 95px; /* Desktop: larger header */
            }
        }
        
        .nav-item[data-admin-controlled="true"] {
            display: none;
        }

        .nav-item[data-admin-controlled="true"].admin-enabled {
            display: block;
        }

        /* Live Social Media Section */
        .live-social-section {
            padding: 3rem 0;
            background: var(--bg-light);
        }

        .social-embed {
            background: white;
            border-radius: 15px;
            padding: 2rem;
            box-shadow: var(--shadow);
        }

        .social-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 2rem;
            text-align: left;
        }

        .facebook-logo {
            width: 50px;
            height: 50px;
            background: #1877f2;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        .instagram-logo {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1.5rem;
            flex-shrink: 0;
        }

        /* RFU League Table */
        .rfu-league-section {
            padding: 3rem 0;
            background: white;
        }

        .league-table {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .league-header {
            background: var(--primary-green);
            color: white;
            padding: 1.5rem;
            text-align: center;
        }

        .league-content {
            padding: 2rem;
        }

        /* üéØ OLS 25 FIX: FASTER + SEAMLESS TICKERTAPE */
        .sponsor-banner {
    background: transparent;
    padding: 0.5rem 0;
    box-shadow: none;
    overflow: hidden;
    position: relative;
    border-top: 3px solid var(--accent-gold);
    border-bottom: none;
    margin-top: 0;
    z-index: 1; /* Below fixed header (z-index: 1000) */
    min-height: auto;
    opacity: 0;
    transition: opacity 0.3s ease;
}

.sponsor-banner.ready {
    opacity: 1;
}

/* Ensure sponsor banner clears the fixed header properly */
.sponsor-banner:first-of-type {
    margin-top: 0; /* Body padding-top handles clearance */
}

.sponsor-banner-clickable {
    cursor: pointer;
    transition: background 0.3s ease;
}

.sponsor-banner-clickable:hover {
    background: transparent;
}

.sponsor-ticker {
    display: flex;
    gap: 0.125rem;
    align-items: center;
    padding: 0 1rem;
}


.sponsor-logo-banner {
    flex: 0 0 auto;
    height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
    padding: 0;
    background: transparent;
    border-radius: 0;
    box-shadow: none;
    transition: all 0.3s ease;
    cursor: pointer;
    overflow: hidden;
}

.sponsor-logo-banner:hover {
    transform: scale(1.08);
    filter: brightness(1.1);
    background: transparent;
}

.sponsor-logo-banner img {
    width: auto;
    height: 100%;
    object-fit: contain;
    object-position: center;
    filter: grayscale(20%) opacity(0.85);
    transition: filter 0.3s ease;
}

.sponsor-logo-banner:hover img {
    filter: grayscale(0%) opacity(1);
}

.sponsor-logo-banner.placeholder {
    background: linear-gradient(45deg, var(--primary-green), var(--primary-maroon));
    color: white;
    font-weight: bold;
    font-size: 0.85rem;
    text-align: center;
}

/* Seamless infinite scroll animation */
@keyframes sponsorScroll {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
}

/* üì± Mobile styles */
@media (max-width: 768px) {
    .sponsor-banner {
        margin-top: 70px;
        padding: 0.5rem 0;
        min-height: auto;
    }
    
    .sponsor-ticker {
        gap: 0.125rem;
        /* Animation duration set dynamically by JavaScript based on sponsor count */
    }
    
    .sponsor-logo-banner {
        flex: 0 0 auto;
        height: 70px;
        padding: 0;
        border-radius: 0;
    }
}

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, rgba(var(--primary-green-rgb), 0.75), rgba(var(--primary-maroon-rgb), 0.75)), 
                        url('images/backgrounds/hero-banner.png') center/cover no-repeat;
            min-height: 60vh;
            display: flex;
            align-items: center;
            justify-content: center;
            text-align: center;
            color: white;
            position: relative;
            margin: -100px 0 0 0;
            padding: 100px 1rem 3rem 1rem;
        }

        .hero-content {
            max-width: 800px;
            z-index: 2;
        }

        .hero h1 {
            font-size: 3.5rem;
            margin-bottom: 1rem;
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
        }

        .hero p {
            font-size: 1.3rem;
            margin-bottom: 2rem;
            opacity: 0.9;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.5);
        }

        .cta-buttons {
            display: flex;
            gap: 1rem;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 1rem 2rem;
            border-radius: 30px;
            text-decoration: none;
            font-weight: bold;
            transition: all 0.3s ease;
            display: inline-block;
        }

        .btn-primary {
            background: var(--accent-gold);
            color: var(--primary-green);
        }

        .btn-secondary {
            background: transparent;
            color: white;
            border: 2px solid white;
        }

        .btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.2);
        }

        /* ENHANCED FIXTURES SECTION */
        .fixtures-timeline-container {
            position: relative;
            margin-top: 2rem;
            overflow: hidden;
        }

        .fixtures-timeline {
            display: flex;
            overflow-x: auto;
            overflow-y: hidden;
            gap: 1.5rem;
            padding: 1rem 0;
            scroll-behavior: smooth;
            scroll-snap-type: x mandatory;
            -webkit-overflow-scrolling: touch;
            padding-left: calc(50vw - 160px);
            padding-right: calc(50vw - 160px);
        }

        .fixture-timeline-card:first-child {
            margin-left: 0 !important;
        }

        .fixture-timeline-card:last-child {
            margin-right: 0 !important;
        }

        .fixtures-timeline::-webkit-scrollbar {
            height: 8px;
        }

        .fixtures-timeline::-webkit-scrollbar-track {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
        }

        .fixtures-timeline::-webkit-scrollbar-thumb {
            background: var(--accent-gold);
            border-radius: 10px;
        }

        .fixtures-timeline::-webkit-scrollbar-thumb:hover {
            background: rgba(var(--accent-gold-rgb), 0.8);
        }

        .fixtures-timeline-container::before,
        .fixtures-timeline-container::after {
            content: '';
            position: absolute;
            top: 0;
            bottom: 0;
            width: 80px;
            z-index: 10;
            pointer-events: none;
        }

        .fixtures-timeline-container::before {
            left: 0;
            background: linear-gradient(to right, 
                rgba(var(--primary-green-rgb), 1) 0%, 
                rgba(var(--primary-green-rgb), 0.9) 15%, 
                rgba(var(--primary-green-rgb), 0.7) 35%, 
                rgba(var(--primary-green-rgb), 0.4) 60%, 
                rgba(var(--primary-green-rgb), 0.2) 80%, 
                transparent 100%);
        }

        .fixtures-timeline-container::after {
            right: 0;
            background: linear-gradient(to left, 
                rgba(var(--primary-maroon-rgb), 1) 0%, 
                rgba(var(--primary-maroon-rgb), 0.9) 15%, 
                rgba(var(--primary-maroon-rgb), 0.7) 35%, 
                rgba(var(--primary-maroon-rgb), 0.4) 60%, 
                rgba(var(--primary-maroon-rgb), 0.2) 80%, 
                transparent 100%);
        }

        .match-info {
            background: linear-gradient(135deg, var(--primary-green) 0%, var(--primary-maroon) 100%);
            position: relative;
        }

        .match-info::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.03'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
            pointer-events: none;
        }

        .match-info .container {
            position: relative;
            z-index: 2;
        }

        .match-info .section-title {
            color: white;
            text-shadow: 0 2px 4px rgba(0,0,0,0.3);
        }

        .fixtures-team-filter {
            background: rgba(255,255,255,0.1);
            padding: 1.5rem;
            border-radius: 15px;
            backdrop-filter: blur(10px);
            margin-bottom: 2rem;
        }

        .fixtures-team-filter h3 {
            color: white;
            margin-bottom: 1rem;
            text-shadow: 0 1px 2px rgba(0,0,0,0.3);
        }

        .team-filter-buttons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
            justify-content: center;
        }

        .team-filter-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
        }

        .team-filter-btn:hover {
            background: rgba(255,255,255,0.3);
            border-color: var(--accent-gold);
            transform: translateY(-2px);
        }

        .team-filter-btn.active {
            background: var(--accent-gold);
            color: var(--primary-green);
            border-color: var(--accent-gold);
            box-shadow: 0 5px 15px rgba(var(--accent-gold-rgb), 0.4);
        }

        .timeline-navigation {
            display: flex;
            justify-content: center;
            gap: 1rem;
            margin-top: 2rem;
        }

        .timeline-nav-btn {
            background: rgba(255,255,255,0.2);
            color: white;
            border: 2px solid rgba(255,255,255,0.3);
            padding: 0.8rem 1.5rem;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .timeline-nav-btn:hover {
            background: var(--accent-gold);
            color: var(--primary-green);
            border-color: var(--accent-gold);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(var(--accent-gold-rgb), 0.4);
        }

        .timeline-nav-btn:disabled {
            background: rgba(255,255,255,0.1);
            color: rgba(255,255,255,0.5);
            border-color: rgba(255,255,255,0.1);
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .fixture-timeline-card {
            flex: 0 0 320px;
            background: white;
            border-radius: 15px;
            padding: 1.5rem;
            box-shadow: var(--shadow);
            transition: all 0.3s ease;
            scroll-snap-align: center;
            scroll-snap-stop: always;
            position: relative;
        }

        .fixture-timeline-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.15);
        }

        .fixture-timeline-card.current-match {
            border: 3px solid var(--accent-gold);
            transform: scale(1.05);
            z-index: 10;
        }

        .fixture-timeline-card.past-match {
            opacity: 0.9;
        }

        .fixture-timeline-card.future-match {
            border-left: 4px solid var(--primary-green);
        }

        .match-status {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--primary-green);
            color: white;
            padding: 0.3rem 1rem;
            border-radius: 15px;
            font-size: 0.8rem;
            font-weight: bold;
        }

        .match-status.current {
            background: var(--accent-gold);
            color: var(--primary-green);
        }

        .match-status.upcoming {
            background: var(--primary-maroon);
        }

        .match-teams-timeline {
            font-size: 1.1rem;
            font-weight: bold;
            color: var(--primary-green);
            margin-bottom: 1rem;
            text-align: center;
        }

        .match-score-timeline {
            font-size: 2rem;
            font-weight: bold;
            text-align: center;
            margin: 1rem 0;
            color: var(--primary-maroon);
        }

        .match-date-timeline {
            text-align: center;
            color: var(--text-light);
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .match-details-timeline {
            text-align: center;
            color: var(--text-light);
            font-size: 0.85rem;
            margin-bottom: 1rem;
        }

        .match-competition-timeline {
            background: var(--bg-light);
            padding: 0.5rem;
            border-radius: 8px;
            text-align: center;
            font-size: 0.8rem;
            color: var(--text-dark);
            font-style: italic;
        }

        @media (max-width: 768px) {
            .live-social-section .container > div[style*="grid-template-columns"] {
                grid-template-columns: 1fr !important;
                gap: 2rem;
            }
            
            .social-header {
                flex-direction: column;
                text-align: center;
                gap: 1rem;
            }

            .sponsor-banner {
        margin-top: 70px;
        padding: 0.5rem 0;
        min-height: auto;
    }
            .sponsor-ticker {
                gap: 0.125rem;
            }
            
            .sponsor-logo-banner {
                flex: 0 0 auto;
                height: 70px;
                padding: 0;
                border-radius: 0;
            }

            .hero h1 {
                font-size: 2.5rem;
            }

            .hero p {
                font-size: 1.1rem;
            }

            .cta-buttons {
                flex-direction: column;
                align-items: center;
            }

            .fixtures-timeline {
                padding-left: calc(50vw - 140px);
                padding-right: calc(50vw - 140px);
                gap: 1rem;
            }

            .fixture-timeline-card {
                flex: 0 0 280px;
            }

            .timeline-navigation {
                flex-direction: column;
                align-items: center;
            }
        }

        /* üéØ PREVENT FLASH OF DEFAULT CONTENT */
        .hero h1,
        .hero p,
        .section-title,
        .stat-item,
        .about-text {
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .cms-content-loaded .hero h1,
        .cms-content-loaded .section-title,
        .cms-content-loaded .stat-item,
        .cms-content-loaded .about-text {
            opacity: 1;
        }
        
        /* Hero tagline uses 0.9 opacity for design (subtle transparency) */
        .cms-content-loaded .hero p {
            opacity: 0.9;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <!-- Universal Header -->
    <div id="header-placeholder" data-page="home"></div>

    <!-- üéØ OLS 25: Sponsor Banner with Admin Toggle Control -->
    <section class="sponsor-banner sponsor-banner-clickable" id="sponsorBanner" style="display: none;" onclick="window.location.href='pages/sponsors.html';" title="Click to view all sponsors">
        <div class="sponsor-ticker" id="sponsorTickerMain">
            <!-- Sponsors loaded dynamically -->
        </div>
    </section>

    <!-- Hero Section -->
    <section id="home" class="hero">
        <div class="hero-content">
            <h1>Welcome to Old Laurentian RFC</h1>
            <p>Proudly representing tradition, excellence, and the spirit of rugby since our founding</p>
            <div class="cta-buttons">
                <a href="pages/fixtures.html" class="btn btn-primary">View Fixtures</a>
                <a href="#about" class="btn btn-secondary">About Our Club</a>
            </div>
        </div>
    </section>

    <!-- Fixtures & Results Timeline (MOVED UP) -->
    <section id="fixtures" class="match-info">
        <div class="container">
            <h2 class="section-title fade-in">Fixtures & Results</h2>
            
            <div class="fixtures-team-filter">
                <h3>Select Team:</h3>
                
                <!-- MOBILE DROPDOWN (hidden on desktop) -->
                <div class="fixtures-filter-mobile">
                    <select id="fixtures-team-select" 
                            style="width: 100%; padding: 1rem; border: 2px solid var(--primary-green); border-radius: 10px; font-size: 1rem; font-weight: bold; color: var(--primary-green); background: white; cursor: pointer;">
                        <!-- Dynamically populated by loadTeamFilters() -->
                    </select>
                </div>
                
                <!-- DESKTOP BUTTONS (hidden on mobile) -->
                <div class="team-filter-buttons fixtures-filter-desktop" id="team-filter-buttons">
                    <!-- Dynamically populated by loadTeamFilters() -->
                </div>
            </div>
            
            <div class="fixtures-timeline-container">
                <div class="fixtures-timeline" id="fixtures-timeline">
                    <!-- Timeline cards populated by JavaScript -->
                </div>
                
                <div class="timeline-navigation">
                    <button class="timeline-nav-btn" id="scrollLeft" onclick="scrollTimeline('left')">‚Üê Past Results</button>
                    <button class="timeline-nav-btn" id="scrollRight" onclick="scrollTimeline('right')">Future Fixtures ‚Üí</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Our SociOLS Section -->
    <section class="live-social-section">
        <div class="container">
            <h2 class="section-title fade-in">Our SociOLS</h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; margin-bottom: 3rem;">
                
                <!-- Instagram Feed -->
                <div class="social-embed social-embed-instagram">
                    <div id="instagram-feed">
                        <iframe src="https://www.instagram.com/olsrugby/embed" 
                                width="100%" 
                                height="700" 
                                class="instagram-iframe"
                                style="border:none;overflow:hidden;border-radius:10px;" 
                                scrolling="no" 
                                frameborder="0">
                        </iframe>
                    </div>
                </div>
                
                <!-- Facebook Feed -->
                <div class="social-embed social-embed-facebook">
                    <div id="facebook-desktop" class="facebook-desktop-only">
                        <iframe src="https://www.facebook.com/plugins/page.php?href=https%3A%2F%2Fwww.facebook.com%2Folsrugby&tabs=timeline&width=500&height=700&small_header=false&adapt_container_width=true&hide_cover=false&show_facepile=true" 
                                width="100%" 
                                height="700" 
                                style="border:none; overflow:hidden; border-radius:10px;" 
                                scrolling="no" 
                                frameborder="0" 
                                allowfullscreen="true" 
                                allow="autoplay; clipboard-write; encrypted-media; picture-in-picture; web-share">
                        </iframe>
                    </div>
                    
                    <div id="facebook-mobile" class="facebook-mobile-only">
                        <div style="text-align: center; padding: 2rem 1rem; background: linear-gradient(135deg, #f0f2f5 0%, #e4e6eb 100%); border-radius: 10px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                            <div style="width: 50px; height: 50px; background: #1877f2; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 1rem; box-shadow: 0 4px 12px rgba(24, 119, 242, 0.3);">
                                <svg width="25" height="25" fill="white" viewBox="0 0 24 24">
                                    <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
                                </svg>
                            </div>
                            <h3 style="color: #1877f2; margin-bottom: 1rem; font-size: 1rem; font-weight: bold;">Follow Us</h3>
                            <a href="https://www.facebook.com/olsrugby" 
                               target="_blank" 
                               style="display: inline-block; padding: 0.7rem 1.8rem; background: #1877f2; color: white; text-decoration: none; border-radius: 25px; font-weight: bold; font-size: 0.9rem; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(24, 119, 242, 0.4);">
                                üìò Facebook
                            </a>
                        </div>
                    </div>
                </div>
                
                <!-- League Table (Mobile Compact - next to Facebook) -->
                <div class="social-embed league-mobile-compact">
                    <div class="league-mobile-only">
                        <div style="text-align: center; padding: 2rem 1rem; background: linear-gradient(135deg, var(--primary-green), var(--primary-maroon)); border-radius: 10px; display: flex; flex-direction: column; align-items: center; justify-content: center; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                            <div style="font-size: 2.5rem; margin-bottom: 1rem;">üèÜ</div>
                            <h3 style="color: white; margin-bottom: 1rem; font-size: 1rem; font-weight: bold;">League Table</h3>
                            <a href="https://www.englandrugby.com/fixtures-and-results/search-results?division=66509&competition=1597&season=2025-2026#tables" 
                               target="_blank" 
                               style="display: inline-block; padding: 0.7rem 1.8rem; background: var(--accent-gold); color: var(--primary-green); text-decoration: none; border-radius: 25px; font-weight: bold; font-size: 0.9rem; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.2);">
                                üèâ View Table
                            </a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <style>
    .social-embed-instagram {
        background: white;
        border-radius: 15px;
        padding: 0;
        box-shadow: var(--shadow);
        overflow: hidden;
        min-height: auto !important;
    }

    .social-embed-instagram #instagram-feed {
        position: relative;
        width: 100%;
        min-height: 400px;
    }

    .instagram-iframe {
        display: block;
        width: 100% !important;
        min-height: 400px;
        max-height: 700px;
    }

    .social-embed-facebook {
        background: white;
        border-radius: 15px;
        padding: 0;
        box-shadow: var(--shadow);
        overflow: hidden;
    }

    .facebook-desktop-only {
        display: block;
    }

    .facebook-mobile-only {
        display: none;
    }
    
    .league-desktop-only {
        display: block;
    }
    
    .league-mobile-only {
        display: none;
    }
    
    .league-mobile-compact {
        display: none;
    }

    @media (max-width: 768px) {
        /* Keep Instagram normal, make Facebook and League side-by-side */
        .live-social-section .container > div[style*="grid-template-columns"] {
            display: grid !important;
            grid-template-columns: 1fr 1fr !important;
            gap: 0.75rem !important;
        }
        
        .live-social-section {
            padding: 2rem 0 1rem 0 !important;
        }
        
        /* Hide the standalone League Table section on mobile */
        .external-link-section {
            display: none !important;
        }
        
        /* Instagram takes full width */
        .social-embed-instagram {
            grid-column: 1 / -1 !important;
            min-height: 500px !important;
            max-height: 600px !important;
            height: auto !important;
            padding: 0 !important;
            margin-bottom: 0.75rem !important;
            width: 100% !important;
            max-width: 100% !important;
        }
        
        .instagram-iframe {
            height: 500px !important;
            max-height: 600px !important;
            min-height: 400px !important;
            width: 100% !important;
        }
        
        /* Facebook and League cards - uniform styling */
        .social-embed-facebook,
        .league-mobile-compact {
            min-height: auto !important;
            padding: 0 !important;
            width: 100% !important;
            max-width: 100% !important;
        }
        
        /* Make card contents uniform height */
        .social-embed-facebook .facebook-mobile-only > div,
        .league-mobile-compact .league-mobile-only > div {
            min-height: 180px !important;
            display: flex !important;
            flex-direction: column !important;
            justify-content: center !important;
        }
        
        .facebook-desktop-only {
            display: none !important;
        }
        
        .facebook-mobile-only {
            display: block !important;
        }
        
        .league-mobile-compact {
            display: block !important;
        }
        
        .league-mobile-only {
            display: block !important;
        }
    }
    </style>

    <style>
    /* üéØ OLS 111: Limit news articles on homepage - 6 desktop, 3 mobile */
    .news-grid .news-card:nth-child(n+7) {
        display: none;
    }
    
    @media (max-width: 768px) {
        .news-grid .news-card:nth-child(n+4) {
            display: none;
        }
    }
    </style>

    <!-- Latest News -->
    <section id="news" class="news-section">
        <div class="container">
            <h2 class="section-title fade-in">Latest News</h2>
            <div class="news-grid">
                <!-- News articles populated by JavaScript -->
            </div>
            <!-- üéØ ADD THIS NEW SECTION -->
        <div style="text-align: center; margin-top: 3rem;">
            <a href="pages/news.html" class="btn" style="display: inline-flex; align-items: center; gap: 0.5rem; padding: 1rem 2.5rem; background: var(--primary-green); color: white; text-decoration: none; border-radius: 30px; font-weight: bold; font-size: 1.1rem; transition: all 0.3s ease;">
                üì∞ View All News
            </a>
        </div>
        <!-- üéØ END OF NEW SECTION --
        </div>
    </section>

    <!-- RFU League Table -->
    <section class="rfu-league-section external-link-section">
        <div class="container">
            <h2 class="section-title fade-in external-links-desktop-title">League Table</h2>
            <div class="league-table">
                <!-- Desktop Version -->
                <div class="league-desktop-only">
                    <div class="league-header">
                        <h3>üèÜ Current League Standings</h3>
                        <p>Live from RFU - Updated Weekly</p>
                    </div>
                    <div class="league-content">
                        <div id="rfu-league-table" style="text-align: center; padding: 3rem 2rem;">
                            <a href="https://www.englandrugby.com/fixtures-and-results/search-results?division=66509&competition=1597&season=2025-2026#tables" 
                               target="_blank" 
                               style="display: inline-block; background: linear-gradient(135deg, var(--primary-green), var(--primary-maroon)); color: white; padding: 1.2rem 3rem; border-radius: 50px; text-decoration: none; font-size: 1.2rem; font-weight: bold; box-shadow: 0 8px 25px rgba(0,0,0,0.2); transition: all 0.3s ease;"
                               onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 12px 35px rgba(0,0,0,0.3)';"
                               onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 25px rgba(0,0,0,0.2)';">
                                üèâ View Official League Table
                            </a>
                            <p style="margin-top: 1.5rem; font-size: 0.9rem; color: #666;">
                                Opens in new tab ‚Ä¢ Official England Rugby data
                            </p>
                        </div>
                    </div>
                </div>
                
                <!-- Mobile Compact Version -->
                <div class="league-mobile-only">
                    <div style="text-align: center; padding: 1.5rem 1rem; background: linear-gradient(135deg, var(--primary-green), var(--primary-maroon)); border-radius: 10px; display: flex; flex-direction: column; align-items: center; justify-content: center;">
                        <div style="font-size: 2rem; margin-bottom: 0.75rem;">üèÜ</div>
                        <h3 style="color: white; margin-bottom: 0.5rem; font-size: 1rem; font-weight: bold;">League Table</h3>
                        <a href="https://www.englandrugby.com/fixtures-and-results/search-results?division=66509&competition=1597&season=2025-2026#tables" 
                           target="_blank" 
                           style="display: inline-block; padding: 0.6rem 1.5rem; background: var(--accent-gold); color: var(--primary-green); text-decoration: none; border-radius: 20px; font-weight: bold; font-size: 0.9rem; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.2);">
                            üèâ View Table
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- COMMENTED OUT - Fixtures section moved up to after hero
    <! -- Fixtures & Results Timeline -- >
    <section id="fixtures" class="match-info">
        <div class="container">
            <h2 class="section-title fade-in">Fixtures & Results</h2>
            
            <div class="fixtures-team-filter">
                <h3>Select Team:</h3>
                
                <! -- MOBILE DROPDOWN (hidden on desktop) -- >
                <div class="fixtures-filter-mobile">
                    <select id="fixtures-team-select" onchange="filterFixturesByTeam(this.value)" 
                            style="width: 100%; padding: 1rem; border: 2px solid var(--primary-green); border-radius: 10px; font-size: 1rem; font-weight: bold; color: var(--primary-green); background: white; cursor: pointer;">
                        <option value="mens-1st">Mens 1st XV</option>
                        <option value="mens-2nd">Mens 2nd XV</option>
                        <option value="ladies">Phoenix Ladies</option>
                        <option value="colts">Colts</option>
                        <option value="u16s">U16s</option>
                        <option value="u14s">U14s</option>
                    </select>
                </div>
                
                <! -- DESKTOP BUTTONS (hidden on mobile) -- >
                <div class="team-filter-buttons fixtures-filter-desktop">
                    <button class="team-filter-btn active" data-team="mens-1st">Mens 1st XV</button>
                    <button class="team-filter-btn" data-team="mens-2nd">Mens 2nd XV</button>
                    <button class="team-filter-btn" data-team="ladies">Phoenix Ladies</button>
                    <button class="team-filter-btn" data-team="colts">Colts</button>
                    <button class="team-filter-btn" data-team="u16s">U16s</button>
                    <button class="team-filter-btn" data-team="u14s">U14s</button>
                </div>
            </div>
            
            <div class="fixtures-timeline-container">
                <div class="fixtures-timeline" id="fixtures-timeline">
                    <! -- Timeline cards populated by JavaScript -- >
                </div>
                
                <div class="timeline-navigation">
                    <button class="timeline-nav-btn" id="scrollLeft" onclick="scrollTimeline('left')">‚Üê Past Results</button>
                    <button class="timeline-nav-btn" id="scrollRight" onclick="scrollTimeline('right')">Future Fixtures ‚Üí</button>
                </div>
            </div>
        </div>
    </section>
    END OF COMMENTED OUT SECTION -->

    <!-- üìÖ CLUB CALENDAR SECTION -->
<!-- Add this after your Fixtures section (around line 680, after </section> for fixtures) -->

<!-- üìÖ CLUB CALENDAR SECTION -->
<!-- Add this after your Fixtures section (around line 680, after </section> for fixtures) -->

<section class="calendar-section" style="padding: 4rem 0; background: var(--bg-light);">
    <div class="container">
        <h2 class="section-title fade-in">üìÖ Club Calendar</h2>
        <p style="text-align: center; color: var(--text-light); margin-bottom: 2rem; font-size: 1.1rem;">
            View all upcoming fixtures, social events, training sessions, and club activities
        </p>
        
        <!-- üéØ CALENDAR FILTER - RESPONSIVE (Dropdown on Mobile, Buttons on Desktop) -->
        <div class="calendar-filters" style="background: rgba(var(--primary-green-rgb), 0.05); padding: 1.5rem; border-radius: 15px; margin-bottom: 2rem;">
            <h3 style="color: var(--primary-green); text-align: center; margin-bottom: 1rem; font-size: 1.2rem;">
                üìã Filter Calendar View
            </h3>
            
            <!-- MOBILE DROPDOWN (hidden on desktop) -->
            <div class="calendar-filter-mobile">
                <select id="calendar-filter-select" onchange="filterCalendarType(this.value)" 
                        style="width: 100%; padding: 1rem; border: 2px solid var(--primary-green); border-radius: 10px; font-size: 1rem; font-weight: bold; color: var(--primary-green); background: white; cursor: pointer;">
                    <option value="all">üìÖ All Events</option>
                    <option value="Senior Fixtures">üî¥ Senior Fixtures</option>
                    <option value="MiniJunior Fixtures">üîµ Mini's/Junior Fixtures</option>
                    <option value="Colts Fixtures">üü¢ Colts Fixtures</option>
                    <option value="Social Events">üü† Social Events</option>
                    <option value="TV Fixtures">üü£ TV Fixtures</option>
                </select>
            </div>
            
            <!-- DESKTOP BUTTONS (hidden on mobile) -->
            <div class="calendar-filter-desktop">
                
                <button class="calendar-filter-btn active" onclick="filterCalendarType('all')" 
                        style="padding: 0.8rem 1.5rem; border: 2px solid var(--primary-green); background: var(--primary-green); color: white; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s ease; font-size: 1rem;">
                    üìÖ All Events
                </button>
                
                <button class="calendar-filter-btn" onclick="filterCalendarType('Senior Fixtures')" 
                        style="padding: 0.8rem 1.5rem; border: 2px solid #e53935; background: white; color: #e53935; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s ease; font-size: 1rem;">
                    <span style="display: inline-block; width: 12px; height: 12px; background: #e53935; border-radius: 50%; margin-right: 0.5rem;"></span>
                    Senior Fixtures
                </button>
                
                <button class="calendar-filter-btn" onclick="filterCalendarType('MiniJunior Fixtures')" 
                        style="padding: 0.8rem 1.5rem; border: 2px solid #1e88e5; background: white; color: #1e88e5; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s ease; font-size: 1rem;">
                    <span style="display: inline-block; width: 12px; height: 12px; background: #1e88e5; border-radius: 50%; margin-right: 0.5rem;"></span>
                    Mini's/Junior Fixtures
                </button>
                
                <button class="calendar-filter-btn" onclick="filterCalendarType('Colts Fixtures')" 
                        style="padding: 0.8rem 1.5rem; border: 2px solid #43a047; background: white; color: #43a047; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s ease; font-size: 1rem;">
                    <span style="display: inline-block; width: 12px; height: 12px; background: #43a047; border-radius: 50%; margin-right: 0.5rem;"></span>
                    Colts Fixtures
                </button>
                
                <button class="calendar-filter-btn" onclick="filterCalendarType('Social Events')" 
                        style="padding: 0.8rem 1.5rem; border: 2px solid #fb8c00; background: white; color: #fb8c00; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s ease; font-size: 1rem;">
                    <span style="display: inline-block; width: 12px; height: 12px; background: #fb8c00; border-radius: 50%; margin-right: 0.5rem;"></span>
                    Social Events
                </button>
                
                <button class="calendar-filter-btn" onclick="filterCalendarType('TV Fixtures')" 
                        style="padding: 0.8rem 1.5rem; border: 2px solid #8e24aa; background: white; color: #8e24aa; border-radius: 25px; cursor: pointer; font-weight: bold; transition: all 0.3s ease; font-size: 1rem;">
                    <span style="display: inline-block; width: 12px; height: 12px; background: #8e24aa; border-radius: 50%; margin-right: 0.5rem;"></span>
                    TV Fixtures
                </button>
                
            </div>
            
            <p style="text-align: center; margin-top: 1rem; color: var(--text-light); font-size: 0.9rem;">
                üí° Select a filter to show only that event type, or "All Events" to see everything
            </p>
        </div>
        
        <!-- üéØ NEW CUSTOM CALENDAR WIDGET -->
        <div id="ols-calendar-widget"></div>
        

        
    </div>
</section>

<!-- üì± CALENDAR FILTER RESPONSIVE STYLES -->
<style>
/* Show buttons on desktop, hide dropdown */
.calendar-filter-desktop {
    display: flex !important;
    gap: 0.75rem;
    flex-wrap: wrap;
    justify-content: center;
}
.calendar-filter-mobile {
    display: none !important;
}

/* Hide buttons on mobile, show dropdown */
@media (max-width: 768px) {
    .calendar-filter-desktop {
        display: none !important;
    }
    .calendar-filter-mobile {
        display: block !important;
    }
    
    .calendar-section .container > p {
        font-size: 1rem !important;
        padding: 0 1rem;
    }
}

/* Calendar filter button hover styles */
.calendar-filter-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.calendar-filter-btn.active {
    transform: scale(1.05);
    box-shadow: 0 6px 16px rgba(0,0,0,0.2);
}
</style>

<!-- üì± MOBILE RESPONSIVE STYLES -->
<style>
@media (max-width: 768px) {
    .calendar-section .calendar-container {
        padding: 1rem !important;
    }
    
    .calendar-section iframe {
        height: 500px !important;
    }
    
    .calendar-section .container > p {
        font-size: 1rem !important;
        padding: 0 1rem;
    }
    
    .calendar-section div[style*="grid-template-columns"] {
        grid-template-columns: 1fr !important;
        gap: 0.75rem !important;
    }
    
    .calendar-filters div[style*="display: flex"] {
        flex-direction: column !important;
        align-items: stretch !important;
    }
    
    .calendar-filter-btn {
        width: 100% !important;
        text-align: center !important;
    }
}

/* Calendar filter button styles */
.calendar-filter-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
}

.calendar-filter-btn.active {
    transform: scale(1.05);
    box-shadow: 0 6px 16px rgba(0,0,0,0.2);
}
</style>

<!-- üìÖ Calendar Filter JavaScript -->
<script>
function filterCalendar(type) {
    // Hide all calendar views
    document.querySelectorAll('.calendar-view').forEach(view => {
        view.style.display = 'none';
    });
    
    // Show selected calendar view
    const selectedView = document.getElementById('calendar-' + type);
    if (selectedView) {
        selectedView.style.display = 'block';
    }
    
    // Update button styles
    document.querySelectorAll('.calendar-filter-btn').forEach(btn => {
        btn.classList.remove('active');
        const btnColor = btn.style.color;
        btn.style.background = 'white';
        btn.style.color = btnColor;
    });
    
    // Style active button
    const activeBtn = document.querySelector(`[data-calendar="${type}"]`);
    if (activeBtn) {
        activeBtn.classList.add('active');
        if (type === 'all') {
            activeBtn.style.background = 'var(--primary-green)';
            activeBtn.style.color = 'white';
        } else {
            const btnBorder = activeBtn.style.borderColor;
            activeBtn.style.background = btnBorder;
            activeBtn.style.color = 'white';
        }
    }
}
</script>

    <!-- Club Stats -->
    <section class="stats-section">
        <div class="container">
            <div class="stats-grid fade-in">
                <div class="stat-item">
                    <span class="stat-number">450+</span>
                    <span class="stat-label">Club Members</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">100+</span>
                    <span class="stat-label">Years of Heritage</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">3</span>
                    <span class="stat-label">Wins This Season</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number">2</span>
                    <span class="stat-label">Senior Teams</span>
                </div>
            </div>
        </div>
    </section>

    <!-- About Section -->
    <section id="about" class="about-section">
        <div class="container">
            <h2 class="section-title fade-in">Welcome Back to Fenley Fields</h2>
            <div class="about-grid">
                <div class="about-text fade-in">
                    <p>"Change is the law of life. And those who look only to the past or the present are certain to miss the future" - John F. Kennedy</p>
                    <p>Our fondest appreciation and gratitude to the more than a century of custodians at Fenley Fields who came before us, came together and made this new dawn in our history possible.</p>
                    <p>In memory of and with sincere gratitude to 'Lol' Fenley & friends - The Original Youngsters.</p>
                    <p>A young man who did see the future and the benefit of sports for all young people.</p>
                    <p>The values which sport & community teach us are gifts to 'catch & pass' - they are not for the game alone.</p>
                    <p>Teamwork, Respect, Pride, Discipline, Commitment & Community.</p>
                    <p>Let's remember why we are here. One story. One club.</p>
                </div>
                <div class="about-image fade-in">
                    <img src="images/backgrounds/club-heritage.png" 
                         alt="Old Laurentian RFC Club Heritage - Historic team photo at Fenley Fields" 
                         style="width: 100%; height: auto; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.2);">
                </div>
            </div>
        </div>
    </section>

    <!-- Club Info Card -->
    <section style="padding: 3rem 0; background: var(--bg-light);">
        <div class="container">
            <div style="background: white; padding: 2.5rem; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                
                <h2 style="color: var(--primary-green); text-align: center; margin-bottom: 2.5rem; font-size: 2rem;">
                    üìç Find Us & Join Us
                </h2>
                
                <div style="text-align: center; padding: 2rem; background: var(--bg-light); border-radius: 12px; margin-bottom: 2rem;">
                    <div style="font-size: 2.5rem; margin-bottom: 1rem;">üìç</div>
                    <h3 style="color: var(--primary-green); margin-bottom: 1rem; font-size: 1.3rem;">Club Address</h3>
                    <p style="color: var(--text-dark); line-height: 1.6; font-size: 1.1rem;">
                        <strong>Fenley Field</strong><br>
                        Lime Tree Avenue<br>
                        Rugby, Warwickshire<br>
                        CV22 7QT
                    </p>
                    <a href="https://maps.google.com/?q=Fenley+Field+Lime+Tree+Avenue+Rugby+CV22+7QT" 
                       target="_blank"
                       style="display: inline-block; margin-top: 1rem; color: var(--primary-maroon); text-decoration: none; font-weight: bold; font-size: 1.1rem;">
                        Get Directions ‚Üí
                    </a>
                </div>

                <h3 style="color: var(--primary-maroon); text-align: center; margin-bottom: 1.5rem; font-size: 1.5rem;">
                    Training Times
                </h3>

                <!-- DESKTOP: Grid View -->
                <div class="training-times-desktop">
                    
                    <div style="padding: 1.5rem; background: linear-gradient(135deg, rgba(var(--primary-green-rgb), 0.1), rgba(var(--primary-maroon-rgb), 0.05)); border-radius: 12px; border: 2px solid var(--primary-green);">
                        <div style="text-align: center; font-size: 2rem; margin-bottom: 0.5rem;"></div>
                        <h4 style="color: var(--primary-green); margin-bottom: 1rem; font-size: 1.1rem; text-align: center; font-weight: bold;">Seniors</h4>
                        <div style="color: var(--text-dark); line-height: 1.8;">
                            <p style="margin-bottom: 0.5rem;">
                                <strong>Tuesday</strong><br>
                                <span style="color: var(--text-light);">7:15pm - 9:00pm</span>
                            </p>
                            <p style="margin-bottom: 0;">
                                <strong>Thursday</strong><br>
                                <span style="color: var(--text-light);">7:15pm - 9:00pm</span>
                            </p>
                        </div>
                    </div>

                    <div style="padding: 1.5rem; background: linear-gradient(135deg, rgba(var(--accent-gold-rgb), 0.1), rgba(var(--primary-maroon-rgb), 0.05)); border-radius: 12px; border: 2px solid var(--accent-gold);">
                        <div style="text-align: center; font-size: 2rem; margin-bottom: 0.5rem;"></div>
                        <h4 style="color: var(--primary-maroon); margin-bottom: 1rem; font-size: 1.1rem; text-align: center; font-weight: bold;">Phoenix Ladies</h4>
                        <div style="color: var(--text-dark); line-height: 1.8;">
                            <p style="margin-bottom: 0;">
                                <strong>Tuesday (Touch)</strong><br>
                                <span style="color: var(--text-light);">7:00pm - 8:00pm</span>
                            </p>
                        </div>
                    </div>

                    <div style="padding: 1.5rem; background: linear-gradient(135deg, rgba(var(--primary-green-rgb), 0.05), rgba(var(--accent-gold-rgb), 0.05)); border-radius: 12px; border: 2px solid var(--primary-green);">
                        <div style="text-align: center; font-size: 2rem; margin-bottom: 0.5rem;"></div>
                        <h4 style="color: var(--primary-green); margin-bottom: 1rem; font-size: 1.1rem; text-align: center; font-weight: bold;">Colts</h4>
                        <div style="color: var(--text-dark); line-height: 1.8;">
                            <p style="margin-bottom: 0.5rem;">
                                <strong>Tuesday</strong><br>
                                <span style="color: var(--text-light);">6:30pm - 7:30pm</span>
                            </p>
                            <p style="margin-bottom: 0;">
                                <strong>Thursday</strong><br>
                                <span style="color: var(--text-light);">6:30pm - 7:30pm</span>
                            </p>
                        </div>
                    </div>

                    <div style="padding: 1.5rem; background: linear-gradient(135deg, rgba(var(--primary-maroon-rgb), 0.05), rgba(var(--primary-green-rgb), 0.05)); border-radius: 12px; border: 2px solid var(--primary-maroon);">
                        <div style="text-align: center; font-size: 2rem; margin-bottom: 0.5rem;"></div>
                        <h4 style="color: var(--primary-maroon); margin-bottom: 1rem; font-size: 1.1rem; text-align: center; font-weight: bold;">Juniors (U13-U16)</h4>
                        <div style="color: var(--text-dark); line-height: 1.8;">
                            <p style="margin-bottom: 0.5rem;">
                                <strong>Wednesday</strong><br>
                                <span style="color: var(--text-light); font-size: 0.9rem;">U13 / U15: 6:00pm - 7:00pm</span><br>
                                <span style="color: var(--text-light); font-size: 0.9rem;">U14 / U16: 7:00pm - 8:00pm</span>
                            </p>
                        </div>
                    </div>

                    <div style="padding: 1.5rem; background: linear-gradient(135deg, rgba(var(--accent-gold-rgb), 0.1), rgba(var(--primary-green-rgb), 0.05)); border-radius: 12px; border: 2px solid var(--accent-gold);">
                        <div style="text-align: center; font-size: 2rem; margin-bottom: 0.5rem;"></div>
                        <h4 style="color: var(--primary-green); margin-bottom: 1rem; font-size: 1.1rem; text-align: center; font-weight: bold;">Minis (U10-U12)</h4>
                        <div style="color: var(--text-dark); line-height: 1.8;">
                            <p style="margin-bottom: 0;">
                                <strong>Friday</strong><br>
                                <span style="color: var(--text-light);">6:00pm - 7:00pm</span>
                            </p>
                        </div>
                    </div>

                    <div style="padding: 1.5rem; background: linear-gradient(135deg, rgba(var(--primary-green-rgb), 0.05), rgba(var(--primary-maroon-rgb), 0.05)); border-radius: 12px; border: 2px solid var(--primary-maroon);">
                        <div style="text-align: center; font-size: 2rem; margin-bottom: 0.5rem;"></div>
                        <h4 style="color: var(--primary-maroon); margin-bottom: 1rem; font-size: 1.1rem; text-align: center; font-weight: bold;">Walking Rugby</h4>
                        <div style="color: var(--text-dark); line-height: 1.8;">
                            <p style="margin-bottom: 0;">
                                <strong>Tuesday</strong><br>
                                <span style="color: var(--text-light);">6:00pm - 7:00pm</span>
                            </p>
                        </div>
                    </div>

                </div>

                <!-- MOBILE: Accordion View -->
                <div class="training-times-mobile">
                    
                    <!-- Seniors Accordion -->
                    <div class="accordion-item" style="margin-bottom: 0.5rem; border-radius: 10px; overflow: hidden; border: 2px solid var(--primary-green);">
                        <button class="accordion-header" onclick="toggleAccordion(this)" 
                                style="width: 100%; padding: 1rem; background: linear-gradient(135deg, rgba(var(--primary-green-rgb), 0.1), rgba(var(--primary-maroon-rgb), 0.05)); border: none; text-align: left; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: bold; color: var(--primary-green); font-size: 1.1rem;">
                            <span>üèâ Seniors</span>
                            <span class="accordion-icon">‚ñº</span>
                        </button>
                        <div class="accordion-content" style="max-height: 0; overflow: hidden; transition: max-height 0.3s ease; background: white;">
                            <div style="padding: 1rem; color: var(--text-dark); line-height: 1.8;">
                                <p style="margin-bottom: 0.5rem;">
                                    <strong>Tuesday</strong><br>
                                    <span style="color: var(--text-light);">7:15pm - 9:00pm</span>
                                </p>
                                <p style="margin-bottom: 0;">
                                    <strong>Thursday</strong><br>
                                    <span style="color: var(--text-light);">7:15pm - 9:00pm</span>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Phoenix Ladies Accordion -->
                    <div class="accordion-item" style="margin-bottom: 0.5rem; border-radius: 10px; overflow: hidden; border: 2px solid var(--accent-gold);">
                        <button class="accordion-header" onclick="toggleAccordion(this)" 
                                style="width: 100%; padding: 1rem; background: linear-gradient(135deg, rgba(var(--accent-gold-rgb), 0.1), rgba(var(--primary-maroon-rgb), 0.05)); border: none; text-align: left; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: bold; color: var(--primary-maroon); font-size: 1.1rem;">
                            <span>üí™ Phoenix Ladies</span>
                            <span class="accordion-icon">‚ñº</span>
                        </button>
                        <div class="accordion-content" style="max-height: 0; overflow: hidden; transition: max-height 0.3s ease; background: white;">
                            <div style="padding: 1rem; color: var(--text-dark); line-height: 1.8;">
                                <p style="margin-bottom: 0;">
                                    <strong>Tuesday (Touch)</strong><br>
                                    <span style="color: var(--text-light);">7:00pm - 8:00pm</span>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Colts Accordion -->
                    <div class="accordion-item" style="margin-bottom: 0.5rem; border-radius: 10px; overflow: hidden; border: 2px solid var(--primary-green);">
                        <button class="accordion-header" onclick="toggleAccordion(this)" 
                                style="width: 100%; padding: 1rem; background: linear-gradient(135deg, rgba(var(--primary-green-rgb), 0.05), rgba(var(--accent-gold-rgb), 0.05)); border: none; text-align: left; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: bold; color: var(--primary-green); font-size: 1.1rem;">
                            <span>‚ö° Colts</span>
                            <span class="accordion-icon">‚ñº</span>
                        </button>
                        <div class="accordion-content" style="max-height: 0; overflow: hidden; transition: max-height 0.3s ease; background: white;">
                            <div style="padding: 1rem; color: var(--text-dark); line-height: 1.8;">
                                <p style="margin-bottom: 0.5rem;">
                                    <strong>Tuesday</strong><br>
                                    <span style="color: var(--text-light);">6:30pm - 7:30pm</span>
                                </p>
                                <p style="margin-bottom: 0;">
                                    <strong>Thursday</strong><br>
                                    <span style="color: var(--text-light);">6:30pm - 7:30pm</span>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Juniors Accordion -->
                    <div class="accordion-item" style="margin-bottom: 0.5rem; border-radius: 10px; overflow: hidden; border: 2px solid var(--primary-maroon);">
                        <button class="accordion-header" onclick="toggleAccordion(this)" 
                                style="width: 100%; padding: 1rem; background: linear-gradient(135deg, rgba(var(--primary-maroon-rgb), 0.05), rgba(var(--primary-green-rgb), 0.05)); border: none; text-align: left; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: bold; color: var(--primary-maroon); font-size: 1.1rem;">
                            <span>üéØ Juniors (U13-U16)</span>
                            <span class="accordion-icon">‚ñº</span>
                        </button>
                        <div class="accordion-content" style="max-height: 0; overflow: hidden; transition: max-height 0.3s ease; background: white;">
                            <div style="padding: 1rem; color: var(--text-dark); line-height: 1.8;">
                                <p style="margin-bottom: 0.5rem;">
                                    <strong>Wednesday</strong><br>
                                    <span style="color: var(--text-light); font-size: 0.9rem;">U13 / U15: 6:00pm - 7:00pm</span><br>
                                    <span style="color: var(--text-light); font-size: 0.9rem;">U14 / U16: 7:00pm - 8:00pm</span>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Minis Accordion -->
                    <div class="accordion-item" style="margin-bottom: 0.5rem; border-radius: 10px; overflow: hidden; border: 2px solid var(--accent-gold);">
                        <button class="accordion-header" onclick="toggleAccordion(this)" 
                                style="width: 100%; padding: 1rem; background: linear-gradient(135deg, rgba(var(--accent-gold-rgb), 0.1), rgba(var(--primary-green-rgb), 0.05)); border: none; text-align: left; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: bold; color: var(--primary-green); font-size: 1.1rem;">
                            <span>üåü Minis (U10-U12)</span>
                            <span class="accordion-icon">‚ñº</span>
                        </button>
                        <div class="accordion-content" style="max-height: 0; overflow: hidden; transition: max-height 0.3s ease; background: white;">
                            <div style="padding: 1rem; color: var(--text-dark); line-height: 1.8;">
                                <p style="margin-bottom: 0;">
                                    <strong>Friday</strong><br>
                                    <span style="color: var(--text-light);">6:00pm - 7:00pm</span>
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Walking Rugby Accordion -->
                    <div class="accordion-item" style="margin-bottom: 0.5rem; border-radius: 10px; overflow: hidden; border: 2px solid var(--primary-maroon);">
                        <button class="accordion-header" onclick="toggleAccordion(this)" 
                                style="width: 100%; padding: 1rem; background: linear-gradient(135deg, rgba(var(--primary-green-rgb), 0.05), rgba(var(--primary-maroon-rgb), 0.05)); border: none; text-align: left; cursor: pointer; display: flex; justify-content: space-between; align-items: center; font-weight: bold; color: var(--primary-maroon); font-size: 1.1rem;">
                            <span>üö∂ Walking Rugby</span>
                            <span class="accordion-icon">‚ñº</span>
                        </button>
                        <div class="accordion-content" style="max-height: 0; overflow: hidden; transition: max-height 0.3s ease; background: white;">
                            <div style="padding: 1rem; color: var(--text-dark); line-height: 1.8;">
                                <p style="margin-bottom: 0;">
                                    <strong>Tuesday</strong><br>
                                    <span style="color: var(--text-light);">6:00pm - 7:00pm</span>
                                </p>
                            </div>
                        </div>
                    </div>

                </div>

                <script>
                function toggleAccordion(button) {
                    const content = button.nextElementSibling;
                    const icon = button.querySelector('.accordion-icon');
                    const isOpen = content.style.maxHeight && content.style.maxHeight !== '0px';
                    
                    if (isOpen) {
                        content.style.maxHeight = '0';
                        icon.textContent = '‚ñº';
                    } else {
                        content.style.maxHeight = content.scrollHeight + 'px';
                        icon.textContent = '‚ñ≤';
                    }
                }
                </script>

                <div style="margin-top: 2rem; padding: 1.5rem; background: linear-gradient(135deg, var(--primary-green), var(--primary-maroon)); border-radius: 12px; text-align: center; color: white;">
                    <p style="font-size: 1.1rem; margin: 0;">
                        <strong>Questions?</strong> Get in touch: 
                        <a href="/cdn-cgi/l/email-protection#523d3e2034313f37363b33123d27263e3d3d397c313d3f" style="color: var(--accent-gold); text-decoration: none; font-weight: bold;"><span class="__cf_email__" data-cfemail="442b283622272921202d25042b3130282b2b2f6a272b29">[email&#160;protected]</span></a>
                    </p>
                </div>

            </div>
        </div>
    </section>

    <style>
    /* Training Times Responsive */
    .training-times-desktop {
        display: grid !important;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }
    .training-times-mobile {
        display: none !important;
        margin-bottom: 2rem;
    }
    
    /* Fixtures Team Filter Responsive */
    .fixtures-filter-desktop {
        display: flex !important;
    }
    .fixtures-filter-mobile {
        display: none !important;
    }
    
    @media (max-width: 768px) {
        .training-times-desktop {
            display: none !important;
        }
        .training-times-mobile {
            display: block !important;
        }
        
        .fixtures-filter-desktop {
            display: none !important;
        }
        .fixtures-filter-mobile {
            display: block !important;
        }
        
        section[style*="padding: 3rem 0"] .container > div {
            padding: 1.5rem !important;
        }
        
        section[style*="padding: 3rem 0"] h2 {
            font-size: 1.5rem !important;
        }
        
        section[style*="padding: 3rem 0"] h3 {
            font-size: 1.2rem !important;
        }
        
        section[style*="padding: 3rem 0"] h4 {
            font-size: 1rem !important;
        }
    }
    </style>

    <!-- Footer -->
    <!-- Universal Footer -->
    <div id="footer-placeholder" data-page="home"></div>

    <!-- Scripts -->
    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script src="js/main.js"></script>
    <script src="js/animations.js"></script>
    <script src="js/olrfc-netlify-data.js"></script>
    <script src="js/admin-data-loader.js"></script>
    <script src="js/news-filter.js"></script>
    <script src="js/fixtures-filter.js"></script>
    <script src="js/calendar-data-fetcher.js"></script>
    <script src="js/calendar-widget.js"></script>
    <script src="js/header.js"></script>
    <script src="js/footer.js"></script>
    

    <script>
        // üéØ OLS 25 FIX: Enhanced Sponsor Banner Loader
        class SponsorBannerLoader {
    constructor() {
        this.sponsors = [];
        this.animationFrameId = null; // Track animation to prevent multiple instances
        this.isLoading = false; // Prevent concurrent loads
        this.debounceTimer = null; // Debounce rapid calls
        this.currentSponsorIds = null; // Track current sponsors to detect changes
        this.isAnimating = false; // Track if animation is running smoothly
        this.init();
    }

    init() {
        console.log('üîÑ SponsorBannerLoader initialized, waiting for feature states...');
        
        // Listen for data updates with debouncing
        // Only listen to storage events for sponsor-specific changes
        window.addEventListener('storage', (e) => {
            if (e.key === 'olrfc_sponsors') {
                this.debouncedLoad();
            }
        });
        window.addEventListener('olrfcDataReady', () => {
            console.log('üîÑ Admin data ready, loading sponsors...');
            this.debouncedLoad();
        });
        window.addEventListener('olrfcFeaturesUpdated', () => {
            console.log('üîÑ Features updated, reloading sponsor banner...');
            this.debouncedLoad();
        });
    }

    // Debounced load to prevent rapid multiple calls
    debouncedLoad() {
        if (this.debounceTimer) {
            clearTimeout(this.debounceTimer);
        }
        this.debounceTimer = setTimeout(() => {
            this.loadSponsorBanner();
        }, 300); // 300ms debounce - better for mobile
    }

    shuffleArray(array) {
        const shuffled = [...array];
        for (let i = shuffled.length - 1; i > 0; i--) {
            const j = Math.floor(Math.random() * (i + 1));
            [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
        }
        return shuffled;
    }

    // Get sponsors from localStorage (synced by admin-data-loader.js)
    getSponsorsFromCache() {
        try {
            const data = localStorage.getItem('olrfc_sponsors');
            if (!data) return [];
            
            const sponsors = JSON.parse(data);
            const activeSponsors = sponsors.filter(s => s.active === true || s.active === 'true');
            
            console.log('üìä Sponsors from cache:', sponsors.length, 'total,', activeSponsors.length, 'active');
            return activeSponsors;
        } catch (e) {
            console.error('‚ùå Error reading sponsors from cache:', e);
            return [];
        }
    }

    async loadSponsorBanner() {
        // Prevent concurrent loads
        if (this.isLoading) {
            console.log('‚ö†Ô∏è Load already in progress, skipping...');
            return;
        }
        
        this.isLoading = true;
        console.log('üîÑ Loading sponsor banner...');
        
        try {
            // Check admin toggle
            const sponsorFeatureEnabled = window.featureStates?.sponsors || false;
            console.log('üéØ Sponsor feature (from global state):', sponsorFeatureEnabled);
            
            const bannerElement = document.getElementById('sponsorBanner');
            const tickerElement = document.getElementById('sponsorTickerMain');
            
            if (!bannerElement || !tickerElement) {
                console.log('‚ùå Banner elements not found');
                return;
            }

            // Hide if admin disabled
            if (!sponsorFeatureEnabled) {
                bannerElement.style.display = 'none';
                bannerElement.classList.remove('ready');
                // Stop animation if running
                if (this.animationFrameId) {
                    cancelAnimationFrame(this.animationFrameId);
                    this.animationFrameId = null;
                    this.isAnimating = false;
                }
                console.log('üö´ Sponsor banner hidden: Admin disabled');
                return;
            }

            // üéØ Get sponsors from localStorage (synced by admin-data-loader.js)
            // admin-data-loader.js runs BEFORE this and syncs all data to localStorage
            const activeSponsors = this.getSponsorsFromCache();

            // If no sponsors, hide banner
            if (activeSponsors.length === 0) {
                console.log('‚è≥ No sponsors available yet (admin-data-loader may still be syncing)');
                bannerElement.style.display = 'none';
                bannerElement.classList.remove('ready');
                // Stop animation if running
                if (this.animationFrameId) {
                    cancelAnimationFrame(this.animationFrameId);
                    this.animationFrameId = null;
                    this.isAnimating = false;
                }
                return;
            }

            // Check if sponsors have actually changed
            const newSponsorIds = activeSponsors.map(s => s.id).sort().join(',');
            if (this.currentSponsorIds === newSponsorIds && this.isAnimating) {
                console.log('‚úÖ Sponsors unchanged, keeping current animation');
                return;
            }
            
            // Sponsors changed, update and restart animation
            this.currentSponsorIds = newSponsorIds;
            console.log('üîÑ Sponsors changed, reinitializing...');
            
            // Cancel any existing animation to prevent multiple instances
            if (this.animationFrameId) {
                cancelAnimationFrame(this.animationFrameId);
                this.animationFrameId = null;
                this.isAnimating = false;
                console.log('üõë Cancelled previous animation');
            }
            
            // Remove ready class to prepare for smooth fade-in
            bannerElement.classList.remove('ready');

            // Show banner with sponsors
            bannerElement.style.display = 'block';
            console.log('‚úÖ Sponsor banner visible with', activeSponsors.length, 'sponsors');
            
            // Randomize order (different on each page load)
            const randomizedSponsors = this.shuffleArray(activeSponsors);
            
            // Double the array so when first set scrolls off, second set is already visible
            const sponsorLogos = [...randomizedSponsors, ...randomizedSponsors];
            
            tickerElement.innerHTML = '';
            
            sponsorLogos.forEach(sponsor => {
                const logoDiv = document.createElement('div');
                logoDiv.className = 'sponsor-logo-banner';
                
                if (sponsor.website) {
                    logoDiv.onclick = () => window.open(sponsor.website, '_blank');
                    logoDiv.style.cursor = 'pointer';
                }

                if (sponsor.logo) {
                    logoDiv.innerHTML = `<img src="${sponsor.logo}" alt="${sponsor.name}" title="${sponsor.name}">`;
                } else {
                    logoDiv.className += ' placeholder';
                    logoDiv.textContent = sponsor.name;
                    logoDiv.title = sponsor.name;
                }

                tickerElement.appendChild(logoDiv);
            });

            // Wait for all images to load before starting animation
            const images = tickerElement.querySelectorAll('img');
            const imageLoadPromises = Array.from(images).map(img => {
                if (img.complete) {
                    return Promise.resolve();
                }
                return new Promise((resolve) => {
                    img.onload = resolve;
                    img.onerror = resolve; // Still resolve even if image fails to prevent blocking
                });
            });

            // Wait for images to load (with timeout fallback)
            await Promise.race([
                Promise.all(imageLoadPromises),
                new Promise(resolve => setTimeout(resolve, 1000)) // 1s timeout fallback
            ]);

            // Small delay to ensure layout is stable
            await new Promise(resolve => setTimeout(resolve, 50));

            // Continuous scroll with requestAnimationFrame (no timed resets)
            let scrollPosition = 0;
            let lastTime = performance.now();
            
            // Detect actual mobile devices, not just narrow windows
            const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent) || window.innerWidth <= 480;
            const pixelsPerSecond = isMobile ? 55 : 60; // Mobile faster, desktop slower
            
            // Calculate actual width dynamically - measure after DOM renders and images load
            const allLogos = tickerElement.querySelectorAll('.sponsor-logo-banner');
            const gapSize = 2; // 0.125rem = 2px
            let singleSetWidth = 0;
            
            // Sum up width of first half only (since we duplicate)
            for (let i = 0; i < allLogos.length / 2; i++) {
                singleSetWidth += allLogos[i].offsetWidth + gapSize;
            }
            
            const scroll = (currentTime) => {
                const deltaTime = (currentTime - lastTime) / 1000; // Convert to seconds
                lastTime = currentTime;
                
                scrollPosition += pixelsPerSecond * deltaTime; // Distance = speed √ó time
                
                // When first set completely scrolls off, reset position (seamless because second set is identical)
                if (scrollPosition >= singleSetWidth) {
                    scrollPosition = 0;
                }
                
                tickerElement.style.transform = `translateX(-${scrollPosition}px)`;
                this.animationFrameId = requestAnimationFrame(scroll);
            };
            
            // Start animation and fade in banner smoothly
            this.animationFrameId = requestAnimationFrame(scroll);
            this.isAnimating = true;
            bannerElement.classList.add('ready');
            
            console.log('‚úÖ', activeSponsors.length, 'sponsors,', pixelsPerSecond, 'px/s', isMobile ? '(mobile device)' : '(desktop)', 'Width:', singleSetWidth + 'px');
        } finally {
            // Always release the lock
            this.isLoading = false;
        }
    }
}

        // Fixtures Timeline (unchanged from your version)
        class FixturesTimeline {
            constructor() {
                this.currentTeam = 'all';
                this.timeline = document.getElementById('fixtures-timeline');
                this.init();
            }

            init() {
                this.setupTeamFilters();
                this.setupDataUpdateListeners();
                this.loadTimelineData();
            }

            setupDataUpdateListeners() {
                window.addEventListener('olrfcDataReady', () => {
                    console.log('üîÑ FixturesTimeline: Data ready, reloading...');
                    this.loadTimelineData();
                });
                
                window.addEventListener('storage', (e) => {
                    if (e.key === 'olrfc_fixtures') {
                        console.log('üîÑ Fixtures updated, reloading...');
                        this.loadTimelineData();
                    }
                });
            }

            setupTeamFilters() {
                // Desktop buttons
                const filterButtons = document.querySelectorAll('.team-filter-btn');
                filterButtons.forEach(btn => {
                    btn.addEventListener('click', () => {
                        filterButtons.forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        this.currentTeam = btn.getAttribute('data-team');
                        this.loadTimelineData();
                    });
                });
                
                // Mobile dropdown
                const mobileSelect = document.getElementById('fixtures-team-select');
                if (mobileSelect) {
                    mobileSelect.addEventListener('change', (e) => {
                        this.currentTeam = e.target.value;
                        this.loadTimelineData();
                        
                        // Also update desktop buttons if switching between views
                        filterButtons.forEach(b => b.classList.remove('active'));
                        const matchingBtn = document.querySelector(`.team-filter-btn[data-team="${e.target.value}"]`);
                        if (matchingBtn) matchingBtn.classList.add('active');
                    });
                }
            }

            getData(key) {
                try {
                    return JSON.parse(localStorage.getItem(`olrfc_${key}`)) || [];
                } catch (e) {
                    console.error(`Error loading ${key}:`, e);
                    return [];
                }
            }

            getTeamName(teamSlug) {
                const teams = this.getData('teams');
                const team = teams.find(t => t.slug === teamSlug);
                return team ? team.name : 'OLS';
            }

            loadTimelineData() {
                // Show all teams if 'all' is selected, otherwise filter by specific team
                const dynamicData = this.currentTeam === 'all' 
                    ? this.getData('fixtures')
                    : this.getData('fixtures').filter(f => f.team === this.currentTeam);
                
                if (dynamicData.length === 0) {
                    this.showLoadingState();
                    return;
                }
                
                const timelineData = this.combineFixtureData([], dynamicData);
                timelineData.sort((a, b) => new Date(a.date) - new Date(b.date));
                
                const currentDate = new Date();
                let currentIndex = -1;
                
                // Find the most recent match that has BOTH: datetime passed AND has scores
                for (let i = timelineData.length - 1; i >= 0; i--) {
                    const matchDateTime = new Date(timelineData[i].date);
                    if (matchDateTime < currentDate && timelineData[i].isResult) {
                        currentIndex = i;
                        break;
                    }
                }
                
                // If no results found, highlight the next upcoming match
                if (currentIndex === -1) {
                    currentIndex = timelineData.findIndex(match => new Date(match.date) >= currentDate);
                    if (currentIndex === -1) currentIndex = 0;
                }
                
                this.renderTimeline(timelineData, currentIndex);
                this.scrollToCurrentMatch(currentIndex);
            }

            showLoadingState() {
                if (!this.timeline) return;
                this.timeline.innerHTML = `
                    <div style="flex: 0 0 320px; background: white; border-radius: 15px; padding: 2rem; text-align: center; box-shadow: var(--shadow);">
                        <div style="display: inline-block; width: 50px; height: 50px; border: 5px solid #f3f3f3; border-top: 5px solid var(--primary-green); border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 1rem;"></div>
                        <h3 style="color: var(--primary-green); margin-bottom: 0.5rem;">Loading Fixtures...</h3>
                        <p style="color: var(--text-light); font-size: 0.9rem;">Fetching latest match data</p>
                    </div>
                `;
            }

            combineFixtureData(staticData, dynamicData) {
                let combined = [];
                dynamicData.forEach(dynFixture => {
                    // Check if scores are actually entered (not null, not empty string, not undefined)
                    const hasValidScores = dynFixture.ourScore !== null && 
                                          dynFixture.ourScore !== '' && 
                                          dynFixture.ourScore !== undefined &&
                                          dynFixture.theirScore !== null && 
                                          dynFixture.theirScore !== '' && 
                                          dynFixture.theirScore !== undefined;
                    
                    combined.push({
                        date: dynFixture.dateTime,
                        opponent: dynFixture.opponent,
                        team: dynFixture.team, // Include team slug
                        isResult: hasValidScores,
                        type: hasValidScores ? 'result' : 'fixture',
                        ourScore: dynFixture.ourScore,
                        theirScore: dynFixture.theirScore,
                        venue: dynFixture.venue === 'home' ? 'Home Ground' : 'Away',
                        competition: dynFixture.competition || 'Friendly',
                        time: new Date(dynFixture.dateTime).toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})
                    });
                });
                return combined;
            }

            renderTimeline(timelineData, currentIndex) {
                this.timeline.innerHTML = '';
                const currentDate = new Date();
                
                timelineData.forEach((match, index) => {
                    const card = document.createElement('div');
                    const matchDateTime = new Date(match.date);  // Full datetime comparison
                    const hasDateTimePassed = matchDateTime < currentDate;  // More explicit naming
                    const isCurrent = index === currentIndex;
                    const isPast = hasDateTimePassed && match.isResult;
                    const isFuture = !hasDateTimePassed;  // DateTime hasn't passed yet
                    
                    card.className = `fixture-timeline-card ${isCurrent ? 'current-match' : ''} ${isPast ? 'past-match' : ''} ${isFuture ? 'future-match' : ''}`;
                    
                    let statusText = 'Upcoming';
                    let statusClass = 'upcoming';
                    
                    // Only show as result/pending if the DATETIME has actually passed
                    if (hasDateTimePassed && match.isResult) {
                        statusText = isCurrent ? 'Latest Result' : 'Past Result';
                        statusClass = isCurrent ? 'current' : 'past';
                    } else if (hasDateTimePassed && !match.isResult) {
                        statusText = 'Result Pending';
                        statusClass = 'upcoming';
                    }
                    
                    if (match.isResult && hasDateTimePassed) {
                        const isWin = parseInt(match.ourScore) > parseInt(match.theirScore);
                        const isDraw = parseInt(match.ourScore) === parseInt(match.theirScore);
                        const resultText = isWin ? 'Victory' : isDraw ? 'Draw' : 'Defeat';
                        
                        // Always show team name for clarity
                        const teamDisplay = this.getTeamName(match.team);
                        
                        card.innerHTML = `
                            <div class="match-status ${statusClass}">${statusText}</div>
                            <div class="match-teams-timeline">${teamDisplay} vs ${match.opponent}</div>
                            <div class="match-score-timeline">${match.ourScore} - ${match.theirScore}</div>
                            <div class="match-date-timeline">${this.formatDate(match.date)}</div>
                            <div class="match-details-timeline">
                                ${match.venue}<br>
                                <strong>${resultText}</strong>
                            </div>
                            <div class="match-competition-timeline">${match.competition || 'Friendly'}</div>
                        `;
                    } else {
                        // Always show team name for clarity
                        const teamDisplay = this.getTeamName(match.team);
                        
                        card.innerHTML = `
                            <div class="match-status ${statusClass}">${statusText}</div>
                            <div class="match-teams-timeline">${teamDisplay} vs ${match.opponent}</div>
                            <div class="match-score-timeline">${match.time || '15:00'}</div>
                            <div class="match-date-timeline">${this.formatDate(match.date)}</div>
                            <div class="match-details-timeline">
                                ${match.venue}<br>
                                <strong>Kick-off: ${match.time || '15:00'}</strong>
                            </div>
                            <div class="match-competition-timeline">${match.competition || 'Friendly'}</div>
                        `;
                    }
                    
                    this.timeline.appendChild(card);
                });
            }

            formatDate(dateString) {
                const date = new Date(dateString);
                return date.toLocaleDateString('en-GB', { 
                    weekday: 'short', 
                    month: 'short', 
                    day: 'numeric',
                    year: 'numeric'
                });
            }

            scrollToCurrentMatch(currentIndex) {
                setTimeout(() => {
                    const timeline = this.timeline;
                    const cards = timeline.querySelectorAll('.fixture-timeline-card');
                    
                    if (!cards[currentIndex]) {
                        if (cards[0]) timeline.scrollTo({ left: 0, behavior: 'smooth' });
                        return;
                    }
                    
                    const targetCard = cards[currentIndex];
                    const container = timeline.parentElement;
                    const containerWidth = container.offsetWidth;
                    const cardWidth = targetCard.offsetWidth;
                    const cardLeft = targetCard.offsetLeft;
                    const scrollPosition = cardLeft - (containerWidth / 2) + (cardWidth / 2);
                    
                    timeline.scrollTo({
                        left: Math.max(0, scrollPosition),
                        behavior: 'smooth'
                    });
                }, 300);
            }
        }

        function scrollTimeline(direction) {
            const timeline = document.getElementById('fixtures-timeline');
            const container = timeline.parentElement;
            const scrollAmount = container.offsetWidth * 0.8;
            
            if (direction === 'left') {
                timeline.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
            } else {
                timeline.scrollBy({ left: scrollAmount, behavior: 'smooth' });
            }
        }

        // üöÄ Enhanced feature state loading with event dispatch
        async function loadFeatureStates() {
    try {
        const response = await fetch('/.netlify/functions/site-settings', {
            method: 'GET'
        });
        
        if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
        }
        
        const result = await response.json();
        const settings = result.data || {};
        
        console.log('üìä Raw settings from Netlify:', settings);
        
        const featureStates = {
            shop: false,
            events: false,
            members: false,
            payments: false,
            sponsors: false
        };
        
        // Extract feature states from settings object
        Object.keys(settings).forEach(key => {
            if (key.startsWith('feature-')) {
                const featureName = key.replace('feature-', '');
                if (featureStates.hasOwnProperty(featureName)) {
                    featureStates[featureName] = settings[key] === 'true';
                }
            }
        });
        
        console.log('‚úÖ Feature states loaded from Netlify:', featureStates);
        
        // üöÄ CRITICAL: Store globally so sponsor banner can access it
        window.featureStates = featureStates;
        
        // Apply saved states to navigation
        Object.keys(featureStates).forEach(feature => {
            const navItems = document.querySelectorAll(`[data-admin-controlled="true"][data-feature="${feature}"]`);
            navItems.forEach(item => {
                item.classList.toggle('admin-enabled', featureStates[feature]);
            });
        });
        
        // üöÄ Dispatch event for sponsor banner
        window.dispatchEvent(new CustomEvent('olrfcFeaturesUpdated', { 
            detail: featureStates 
        }));
        
        return featureStates; // ‚Üê Return so we can await
        
    } catch (error) {
        console.error('‚ùå Error loading feature states:', error);
        
        // üì± Mobile fallback: Default sponsors to TRUE
        const fallbackStates = {
            shop: false,
            events: false,
            members: false,
            payments: false,
            sponsors: true  // ‚Üê Mobile users see banner by default
        };
        
        window.featureStates = fallbackStates;
        
        window.dispatchEvent(new CustomEvent('olrfcFeaturesUpdated', { 
            detail: fallbackStates 
        }));
        
        return fallbackStates;
    }
}
  
        // Initialize everything
        let sponsorBannerLoader;
        let fixturesTimeline;

        document.addEventListener('DOMContentLoaded', async function() {  // ‚Üê Made async
    console.log('üöÄ Page loaded, initializing...');
    
    // Initialize banner loader (but don't load yet)
    window.sponsorBannerLoader = new SponsorBannerLoader();
    
    // Initialize fixtures timeline
    window.fixturesTimeline = new FixturesTimeline();
    
    // üéØ CRITICAL: Load feature states FIRST
    console.log('‚è≥ Loading feature states from Netlify...');
    await loadFeatureStates();  // ‚Üê WAIT here until Netlify responds
    
    // ‚úÖ Sponsor banner loads automatically via 'olrfcFeaturesUpdated' event listener (100ms debounced)
    console.log('‚úÖ Feature states ready, sponsor banner will load automatically...');
    
    setTimeout(() => {
        console.log('üèâ Admin data already synced - news cards safe!');
    }, 2000);
    
    console.log('‚úÖ All components initialized');
});
    </script>

<script>
// üéØ INITIALIZE CALENDAR WIDGET
// Add this to your existing DOMContentLoaded function or create a new one

// Wait for page to load
window.addEventListener('load', async function() {
    console.log('üöÄ Initializing OLS Custom Calendar...');
    
    // Small delay to ensure other scripts have initialized
    setTimeout(async () => {
        try {
            // Create data fetcher
            const dataFetcher = new CalendarDataFetcher();
            
            // Create widget
            window.calendarWidget = new CalendarWidget('ols-calendar-widget', dataFetcher);
            
            console.log('‚úÖ OLS Custom Calendar ready!');
        } catch (error) {
            console.error('‚ùå Error initializing calendar:', error);
        }
    }, 500);
});

// Filter function for the filter buttons
function filterCalendarType(type) {
    if (window.calendarWidget) {
        window.calendarWidget.filterByType(type);
    }
    
    // Update button styles
    document.querySelectorAll('.calendar-filter-btn').forEach(btn => {
        btn.classList.remove('active');
        const btnColor = btn.style.color;
        btn.style.background = 'white';
        btn.style.color = btnColor;
    });
    
    // Style active button
    const clickedBtn = event.target.closest('.calendar-filter-btn');
    if (clickedBtn) {
        clickedBtn.classList.add('active');
        if (type === 'all') {
            clickedBtn.style.background = 'var(--primary-green)';
            clickedBtn.style.color = 'white';
        } else {
            const btnBorder = clickedBtn.style.borderColor;
            clickedBtn.style.background = btnBorder;
            clickedBtn.style.color = 'white';
        }
    }
}

// Close popup when clicking outside
document.addEventListener('click', function(e) {
    const modal = document.getElementById('day-popup-modal');
    if (modal && e.target === modal && window.calendarWidget) {
        window.calendarWidget.closePopup();
    }
});

// Close popup with Escape key
document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape') {
        const modal = document.getElementById('day-popup-modal');
        if (modal && modal.style.display !== 'none' && window.calendarWidget) {
            window.calendarWidget.closePopup();
        }
    }
});
</script>

    <!-- Hidden Netlify Forms for data persistence -->
<form name="olrfc-sponsors" netlify netlify-honeypot="bot-field" hidden>
  <input type="text" name="form-name" value="olrfc-sponsors" />
  <input type="text" name="id" />
  <input type="text" name="name" />
  <input type="text" name="logo" />
  <input type="text" name="website" />
  <input type="text" name="tier" />
  <input type="text" name="phone" />
  <input type="text" name="email" />
  <input type="text" name="address" />
  <input type="text" name="active" />
  <input type="text" name="showInBanner" />
  <input type="text" name="description" />
  <input type="text" name="startDate" />
  <input type="text" name="endDate" />
  <input type="text" name="createdAt" />
</form>

<!-- üéØ ADD THIS NEW FORM -->
<form name="olrfc-news" netlify netlify-honeypot="bot-field" hidden>
  <input type="text" name="form-name" value="olrfc-news" />
  <input type="text" name="id" />
  <input type="text" name="title" />
  <textarea name="content"></textarea>
  <input type="text" name="category" />
  <input type="text" name="author" />
  <input type="text" name="date" />
  <input type="text" name="image" />
  <input type="text" name="featured" />
</form>

<!-- ============================================================================ -->
<!-- üéØ FLOATING FEEDBACK BUTTON & MODAL -->
<!-- Add this code to the bottom of your index.html (before </body>) -->
<!-- ============================================================================ -->

<!-- Floating Feedback Button -->
<button id="feedback-button" class="feedback-btn" aria-label="Send Feedback">
    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M20 2H4C2.9 2 2.01 2.9 2.01 4L2 22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2ZM6 9H18V11H6V9ZM14 14H6V12H14V14ZM18 8H6V6H18V8Z" fill="currentColor"/>
    </svg>
    <span>Feedback</span>
</button>

<!-- Feedback Modal -->
<div id="feedback-modal" class="feedback-modal">
    <div class="feedback-modal-content">
        <div class="feedback-modal-header">
            <h2>üì£ Send Us Your Feedback</h2>
            <button class="feedback-close" id="feedback-close" aria-label="Close">&times;</button>
        </div>
        
        <div class="feedback-modal-body">
            <p style="color: var(--text-light); margin-bottom: 1.5rem;">
                Help us improve! Report bugs, suggest features, or share your thoughts about the new website.
            </p>
            
            <form id="feedback-form" action="https://formspree.io/f/xkgqaooe" method="POST">
                <!-- Hidden field to capture page URL -->
                <input type="hidden" name="page_url" id="feedback-page-url">
                
                <div class="form-group">
                    <label for="feedback-name">Your Name <span style="color: var(--primary-maroon);">*</span></label>
                    <input type="text" id="feedback-name" name="name" required placeholder="Enter your name">
                </div>
                
                <div class="form-group">
                    <label for="feedback-email">Your Email <span style="color: var(--primary-maroon);">*</span></label>
                    <input type="email" id="feedback-email" name="email" required placeholder="your.email@example.com">
                </div>
                
                <div class="form-group">
                    <label for="feedback-type">Feedback Type <span style="color: var(--primary-maroon);">*</span></label>
                    <select id="feedback-type" name="feedback_type" required>
                        <option value="">Select type...</option>
                        <option value="bug">üêõ Bug Report</option>
                        <option value="feature">üí° Feature Request</option>
                        <option value="general">üí¨ General Feedback</option>
                        <option value="content">üìù Content Issue</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label for="feedback-message">Your Message <span style="color: var(--primary-maroon);">*</span></label>
                    <textarea id="feedback-message" name="message" required placeholder="Tell us what's on your mind..." rows="5"></textarea>
                    <small style="color: var(--text-light);">Please be as detailed as possible</small>
                </div>
                
                <div class="form-group">
                    <label>
                        <input type="checkbox" name="subscribe" value="yes" style="margin-right: 8px;">
                        Keep me updated about website improvements
                    </label>
                </div>
                
                <button type="submit" class="btn feedback-submit-btn">
                    <span class="btn-text">Send Feedback</span>
                    <span class="btn-loading" style="display: none;">
                        <span class="spinner"></span> Sending...
                    </span>
                </button>
            </form>
        </div>
    </div>
</div>

<!-- Thank You Modal (shown after successful submission) -->
<div id="feedback-thankyou-modal" class="feedback-modal">
    <div class="feedback-modal-content">
        <div class="feedback-modal-header">
            <h2>üéâ Thank You!</h2>
            <button class="feedback-close" id="thankyou-close" aria-label="Close">&times;</button>
        </div>
        
        <div class="feedback-modal-body" style="text-align: center;">
            <div style="font-size: 4rem; margin: 1rem 0;">‚úÖ</div>
            <h3 style="color: var(--primary-green); margin-bottom: 1rem;">Feedback Received!</h3>
            <p style="color: var(--text-light); margin-bottom: 1.5rem;">
                Thank you for taking the time to share your thoughts with us. Your feedback helps us improve the Old Laurentian RFC website.
            </p>
            <p style="color: var(--text-light); font-size: 0.9rem;">
                We'll review your feedback and get back to you if needed.
            </p>
            <button class="btn" id="thankyou-close-btn" style="margin-top: 1.5rem;">Close</button>
        </div>
    </div>
</div>

<style>
/* ============================================================================ */
/* FEEDBACK BUTTON & MODAL STYLES */
/* ============================================================================ */

/* Floating Feedback Button */
.feedback-btn {
    position: fixed;
    bottom: 30px;
    right: 30px;
    background: var(--primary-green);
    color: white;
    border: none;
    border-radius: 50px;
    padding: 12px 24px;
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    transition: all 0.3s ease;
    z-index: 999;
}

.feedback-btn:hover {
    background: var(--primary-maroon);
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
}

.feedback-btn svg {
    width: 24px;
    height: 24px;
}

/* Mobile: Show icon only */
@media (max-width: 768px) {
    .feedback-btn {
        padding: 16px;
        bottom: 20px;
        right: 20px;
    }
    
    .feedback-btn span {
        display: none;
    }
}

/* Feedback Modal */
.feedback-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    z-index: 1000;
    backdrop-filter: blur(4px);
    animation: fadeIn 0.3s ease;
}

.feedback-modal.active {
    display: flex;
    justify-content: center;
    align-items: center;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

.feedback-modal-content {
    background: white;
    border-radius: 12px;
    width: 90%;
    max-width: 600px;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
    animation: slideUp 0.3s ease;
}

@keyframes slideUp {
    from {
        opacity: 0;
        transform: translateY(50px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.feedback-modal-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 1.5rem 2rem;
    border-bottom: 2px solid var(--primary-green);
    background: linear-gradient(135deg, var(--primary-green) 0%, var(--primary-maroon) 100%);
    border-radius: 12px 12px 0 0;
}

.feedback-modal-header h2 {
    margin: 0;
    color: white;
    font-size: 1.5rem;
}

.feedback-close {
    background: transparent;
    border: none;
    color: white;
    font-size: 2rem;
    cursor: pointer;
    padding: 0;
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    transition: all 0.2s ease;
}

.feedback-close:hover {
    background: rgba(255, 255, 255, 0.2);
    transform: rotate(90deg);
}

.feedback-modal-body {
    padding: 2rem;
}

/* Form Styles */
.feedback-modal .form-group {
    margin-bottom: 1.5rem;
}

.feedback-modal label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 600;
    color: var(--text-dark);
}

.feedback-modal input[type="text"],
.feedback-modal input[type="email"],
.feedback-modal select,
.feedback-modal textarea {
    width: 100%;
    padding: 0.75rem;
    border: 2px solid #e0e0e0;
    border-radius: 8px;
    font-size: 1rem;
    transition: all 0.3s ease;
    font-family: inherit;
}

.feedback-modal input:focus,
.feedback-modal select:focus,
.feedback-modal textarea:focus {
    outline: none;
    border-color: var(--primary-green);
    box-shadow: 0 0 0 3px rgba(0, 128, 0, 0.1);
}

.feedback-modal textarea {
    resize: vertical;
    min-height: 120px;
}

.feedback-submit-btn {
    width: 100%;
    background: var(--primary-green);
    color: white;
    border: none;
    padding: 1rem;
    border-radius: 8px;
    font-size: 1.1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
}

.feedback-submit-btn:hover {
    background: var(--primary-maroon);
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.feedback-submit-btn:disabled {
    background: #ccc;
    cursor: not-allowed;
    transform: none;
}

/* Spinner for loading state */
.spinner {
    display: inline-block;
    width: 16px;
    height: 16px;
    border: 2px solid rgba(255, 255, 255, 0.3);
    border-top-color: white;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

/* Mobile Responsive */
@media (max-width: 768px) {
    .feedback-modal-content {
        width: 95%;
        max-height: 95vh;
    }
    
    .feedback-modal-header {
        padding: 1rem 1.5rem;
    }
    
    .feedback-modal-header h2 {
        font-size: 1.25rem;
    }
    
    .feedback-modal-body {
        padding: 1.5rem;
    }
}
</style>

<script>
// ============================================================================
// FEEDBACK MODAL JAVASCRIPT
// ============================================================================

(function() {
    const feedbackBtn = document.getElementById('feedback-button');
    const feedbackModal = document.getElementById('feedback-modal');
    const thankyouModal = document.getElementById('feedback-thankyou-modal');
    const feedbackClose = document.getElementById('feedback-close');
    const thankyouClose = document.getElementById('thankyou-close');
    const thankyouCloseBtn = document.getElementById('thankyou-close-btn');
    const feedbackForm = document.getElementById('feedback-form');
    
    // Open feedback modal
    feedbackBtn.addEventListener('click', function() {
        feedbackModal.classList.add('active');
        document.body.style.overflow = 'hidden'; // Prevent scrolling
        
        // Capture current page URL
        document.getElementById('feedback-page-url').value = window.location.href;
    });
    
    // Close feedback modal
    function closeFeedbackModal() {
        feedbackModal.classList.remove('active');
        document.body.style.overflow = ''; // Restore scrolling
    }
    
    feedbackClose.addEventListener('click', closeFeedbackModal);
    
    // Close when clicking outside modal
    feedbackModal.addEventListener('click', function(e) {
        if (e.target === feedbackModal) {
            closeFeedbackModal();
        }
    });
    
    // Close thank you modal
    function closeThankYouModal() {
        thankyouModal.classList.remove('active');
        document.body.style.overflow = '';
    }
    
    thankyouClose.addEventListener('click', closeThankYouModal);
    thankyouCloseBtn.addEventListener('click', closeThankYouModal);
    
    thankyouModal.addEventListener('click', function(e) {
        if (e.target === thankyouModal) {
            closeThankYouModal();
        }
    });
    
    // Handle form submission
    feedbackForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        const submitBtn = feedbackForm.querySelector('.feedback-submit-btn');
        const btnText = submitBtn.querySelector('.btn-text');
        const btnLoading = submitBtn.querySelector('.btn-loading');
        
        // Show loading state
        submitBtn.disabled = true;
        btnText.style.display = 'none';
        btnLoading.style.display = 'inline-flex';
        
        try {
            // Submit to Formspree
            const formData = new FormData(feedbackForm);
            const response = await fetch(feedbackForm.action, {
                method: 'POST',
                body: formData,
                headers: {
                    'Accept': 'application/json'
                }
            });
            
            if (response.ok) {
                // Success! Close feedback modal and show thank you
                closeFeedbackModal();
                feedbackForm.reset();
                
                // Small delay for smooth transition
                setTimeout(() => {
                    thankyouModal.classList.add('active');
                }, 300);
            } else {
                throw new Error('Form submission failed');
            }
        } catch (error) {
            alert('Oops! There was a problem submitting your feedback. Please try again or email us directly.');
            console.error('Feedback submission error:', error);
        } finally {
            // Reset button state
            submitBtn.disabled = false;
            btnText.style.display = 'inline';
            btnLoading.style.display = 'none';
        }
    });
    
    // Close modals with Escape key
    document.addEventListener('keydown', function(e) {
        if (e.key === 'Escape') {
            if (feedbackModal.classList.contains('active')) {
                closeFeedbackModal();
            }
            if (thankyouModal.classList.contains('active')) {
                closeThankYouModal();
            }
        }
    });
})();
</script>

<!-- ============================================================================ -->
<!-- DYNAMIC CMS CONTENT LOADER - OLS 94 -->
<!-- Dual-loading approach: localStorage first (instant), then Netlify refresh -->
<!-- ============================================================================ -->
<script>
(async function() {
    try {
        let settingsToApply = null;
        let loadedFromCache = false;
        
        // üöÄ STEP 1: Check localStorage FIRST (instant, no flash)
        const cachedSettings = localStorage.getItem('olrfc_site-settings');
        if (cachedSettings) {
            try {
                settingsToApply = JSON.parse(cachedSettings);
                loadedFromCache = true;
                console.log('‚ö° Using cached settings (instant load, no flash)');
                applyContent(settingsToApply);
                document.body.classList.add('cms-content-loaded'); // Show content immediately
            } catch (e) {
                console.warn('‚ö†Ô∏è Cache parse error:', e);
            }
        }
        
        // üåê STEP 2: Fetch fresh data from Netlify (background refresh OR first load)
        const response = await fetch('/.netlify/functions/site-settings', {
            method: 'GET'
        });
        
        if (response.ok) {
            const result = await response.json();
            const freshSettings = result.data || {};
            
            // Update localStorage cache
            localStorage.setItem('olrfc_site-settings', JSON.stringify(freshSettings));
            
            // Only re-apply if content changed OR this is first load
            if (!loadedFromCache) {
                console.log('üì° First load: applying fresh settings from Netlify');
                applyContent(freshSettings);
                document.body.classList.add('cms-content-loaded'); // Show content with fade-in
            } else if (JSON.stringify(freshSettings) !== cachedSettings) {
                console.log('üîÑ Content updated, refreshing page...');
                applyContent(freshSettings);
            }
        } else if (!loadedFromCache) {
            // No cache AND Netlify failed - show defaults
            console.log('‚ö†Ô∏è No cache, Netlify unavailable - using defaults');
            document.body.classList.add('cms-content-loaded'); // Show defaults
        }
        
        function applyContent(settingsData) {
            // Build content map (only homepage fields)
            const content = {};
            Object.keys(settingsData).forEach(key => {
                if (key.startsWith('homepage-')) {
                    content[key] = settingsData[key];
                }
            });
            
            // Helper function to get content with fallback
            const get = (key, fallback) => content[key] || fallback;
            
            // 1. Page Title
            const pageTitle = get('homepage-page-title', 'Old Laurentian RFC - Est. 1919');
            document.title = pageTitle;
            
            // 2. Hero Section - Heading
            const heroHeading = document.querySelector('.hero h1');
            if (heroHeading) {
                const headingText = get('homepage-hero-heading', 'Welcome to Old Laurentian RFC');
                heroHeading.textContent = headingText;
            }
            
            // 3. Hero Section - Tagline
            const heroTagline = document.querySelector('.hero p');
            if (heroTagline) {
                const taglineText = get('homepage-hero-tagline', 'Proudly representing tradition, excellence, and the spirit of rugby since our founding');
                heroTagline.textContent = taglineText;
            }
            
            // 4. Fixtures Section Title
            const fixturesSection = document.querySelector('#fixtures .section-title');
            if (fixturesSection) {
                const fixturesTitle = get('homepage-fixtures-title', 'Fixtures & Results');
                fixturesSection.textContent = fixturesTitle;
            }
            
            // 5. Social Section Title (after fixtures)
            const socialSection = document.querySelector('.live-social-section .section-title');
            if (socialSection) {
                const socialTitle = get('homepage-social-title', 'Our Socials');
                socialSection.textContent = socialTitle;
            }
            
            // 6. News Section Title
            const newsSection = document.querySelector('#news .section-title');
            if (newsSection) {
                const newsTitle = get('homepage-news-title', 'Latest News');
                newsSection.textContent = newsTitle;
            }
            
            // 7. League Table Section Title
            const leagueSection = document.querySelector('.rfu-league-section .section-title');
            if (leagueSection) {
                const leagueTitle = get('homepage-league-title', 'League Table');
                leagueSection.textContent = leagueTitle;
            }
            
            // 8. Calendar Section Title
            const calendarSection = document.querySelector('.calendar-section .section-title');
            if (calendarSection) {
                const calendarTitle = get('homepage-calendar-title', 'üìÖ Club Calendar');
                calendarSection.textContent = calendarTitle;
            }
            
            // 9. About Section Title
            const aboutSection = document.querySelector('#about .section-title');
            if (aboutSection) {
                const aboutTitle = get('homepage-about-title', 'Welcome Back to Fenley Fields');
                aboutSection.textContent = aboutTitle;
            }
            
            // 10. Find Us Section Title
            const findUsTitle = document.querySelector('section[style*="padding: 3rem 0; background: var(--bg-light)"] h2');
            if (findUsTitle && findUsTitle.textContent.includes('üìç')) {
                const findUsText = get('homepage-findus-title', 'üìç Find Us & Join Us');
                findUsTitle.textContent = findUsText;
            }
            
            // 11. Training Times Title
            const trainingTitle = document.querySelector('h3[style*="color: var(--primary-maroon); text-align: center"]');
            if (trainingTitle && trainingTitle.textContent.includes('Training')) {
                const trainingText = get('homepage-training-title', 'Training Times');
                trainingTitle.textContent = trainingText;
            }
            
            // 12-19. Stats Section (4 stats with numbers + labels)
            const statItems = document.querySelectorAll('.stat-item');
            if (statItems.length >= 4) {
                // Default values for fallback
                const defaultStats = [
                    { number: '450+', label: 'Club Members' },
                    { number: '100+', label: 'Years of Heritage' },
                    { number: '3', label: 'Wins This Season' },
                    { number: '2', label: 'Senior Teams' }
                ];
                
                // Update each stat
                for (let i = 1; i <= 4; i++) {
                    const stat = statItems[i - 1];
                    const number = stat.querySelector('.stat-number');
                    const label = stat.querySelector('.stat-label');
                    
                    if (number) {
                        const numValue = get(`homepage-stat${i}-number`, defaultStats[i - 1].number);
                        number.textContent = numValue;
                    }
                    
                    if (label) {
                        const labelValue = get(`homepage-stat${i}-label`, defaultStats[i - 1].label);
                        label.textContent = labelValue;
                    }
                }
            }
            
            // 20. About Content (with paragraph handling)
            const aboutText = document.querySelector('.about-text');
            if (aboutText) {
                const aboutContent = get('homepage-about-content', '');
                
                if (aboutContent) {
                    // Clear existing paragraphs
                    aboutText.innerHTML = '';
                    
                    // Split by line breaks and create new paragraphs
                    const paragraphs = aboutContent.split(/\n+/).filter(p => p.trim());
                    
                    if (paragraphs.length > 0) {
                        paragraphs.forEach(paraText => {
                            const p = document.createElement('p');
                            p.textContent = paraText.trim();
                            aboutText.appendChild(p);
                        });
                    }
                }
            }
            
            // 21. Instagram URL - convert to embed format
            const instagramUrl = get('homepage-instagram-url', 'https://www.instagram.com/olsrugby/');
            if (instagramUrl) {
                // Smart processing: convert profile URL to embed URL
                let embedUrl = instagramUrl;
                if (!embedUrl.endsWith('/embed')) {
                    embedUrl = embedUrl.replace(/\/$/, '') + '/embed';
                }
                
                // Update Instagram iframe
                const instagramIframe = document.querySelector('.instagram-iframe');
                if (instagramIframe) {
                    instagramIframe.src = embedUrl;
                }
            }
            
            // 22. Facebook URL - convert to plugin format for desktop, direct for mobile
            const facebookUrl = get('homepage-facebook-url', 'https://www.facebook.com/olsrugby');
            if (facebookUrl) {
                // Desktop: Facebook plugin iframe
                const facebookIframe = document.querySelector('#facebook-desktop iframe');
                if (facebookIframe) {
                    const encodedUrl = encodeURIComponent(facebookUrl);
                    const pluginUrl = `https://www.facebook.com/plugins/page.php?href=${encodedUrl}&tabs=timeline&width=500&height=700&small_header=false&adapt_container_width=true&hide_cover=false&show_facepile=true`;
                    facebookIframe.src = pluginUrl;
                }
                
                // Mobile: Direct link button
                const facebookMobileBtn = document.querySelector('#facebook-mobile a');
                if (facebookMobileBtn) {
                    facebookMobileBtn.href = facebookUrl;
                }
            }
            
            // 23. League Table URL - apply to all 3 locations
            const leagueUrl = get('homepage-league-url', 'https://www.englandrugby.com/fixtures-and-results/search-results?division=66509&competition=1597&season=2025-2026#tables');
            if (leagueUrl) {
                // Mobile button (in social section)
                const leagueMobileBtn = document.querySelector('.league-mobile-compact a');
                if (leagueMobileBtn) {
                    leagueMobileBtn.href = leagueUrl;
                }
                
                // Desktop button (in RFU league section)
                const leagueDesktopBtn = document.querySelector('#rfu-league-table a');
                if (leagueDesktopBtn) {
                    leagueDesktopBtn.href = leagueUrl;
                }
                
                // Desktop link (alternative location if exists)
                const leagueDesktopLink = document.querySelector('.league-desktop-only a');
                if (leagueDesktopLink) {
                    leagueDesktopLink.href = leagueUrl;
                }
            }
            
            // 24. Hero Background Image - Update CSS background-image
            const heroBackgroundUrl = get('homepage-hero-background', '');
            if (heroBackgroundUrl) {
                const heroSection = document.querySelector('.hero');
                if (heroSection) {
                    // Update the background-image URL in the inline style or via CSS
                    const currentBg = window.getComputedStyle(heroSection).backgroundImage;
                    const newBg = currentBg.replace(/url\(['"]?[^'"]*['"]?\)/g, `url('${heroBackgroundUrl}')`);
                    heroSection.style.backgroundImage = newBg;
                    console.log('üñºÔ∏è Hero background updated:', heroBackgroundUrl);
                }
            }
            
            // 25. Heritage/About Image - Update src
            const heritageImageUrl = get('homepage-heritage-image', '');
            if (heritageImageUrl) {
                const heritageImg = document.querySelector('.about-image img');
                if (heritageImg) {
                    heritageImg.src = heritageImageUrl;
                    console.log('üñºÔ∏è Heritage image updated:', heritageImageUrl);
                }
            }
            
            console.log('‚úÖ Homepage CMS content applied (25 fields)');
        }
        
    } catch (error) {
        console.error('‚ùå Error loading CMS content:', error);
        // Show defaults even if error
        document.body.classList.add('cms-content-loaded');
    }
})();
</script>

<!-- Dynamic Team Filters Loader -->
<script>
(function() {
    /**
     * Load teams from Netlify Blobs and populate fixtures team filters
     */
    async function loadTeamFilters() {
        try {
            console.log('üì• Loading teams from Netlify Blobs for fixtures filters...');
            
            // Fetch teams from Netlify Blobs
            const response = await fetch('/.netlify/functions/teams', {
                method: 'GET'
            });
            
            if (!response.ok) {
                throw new Error('Failed to fetch teams from Netlify');
            }
            
            const result = await response.json();
            const teams = result.data || [];
            
            console.log(`üìä Loaded ${teams.length} teams for fixtures filters`);
            
            // Get filter elements
            const mobileSelect = document.getElementById('fixtures-team-select');
            const desktopButtons = document.getElementById('team-filter-buttons');
            
            if (!mobileSelect || !desktopButtons) {
                console.warn('‚ö†Ô∏è Team filter elements not found');
                return;
            }
            
            // Clear existing content
            mobileSelect.innerHTML = '';
            desktopButtons.innerHTML = '';
            
            // Add "All Teams" option first
            const allOption = document.createElement('option');
            allOption.value = 'all';
            allOption.selected = true;
            allOption.textContent = 'All Teams';
            mobileSelect.appendChild(allOption);
            
            const allButton = document.createElement('button');
            allButton.className = 'team-filter-btn active';
            allButton.setAttribute('data-team', 'all');
            allButton.textContent = 'All Teams';
            desktopButtons.appendChild(allButton);
            
            // Add each team
            teams.forEach(team => {
                // Mobile dropdown option
                const option = document.createElement('option');
                option.value = team.slug;
                option.textContent = team.name;
                mobileSelect.appendChild(option);
                
                // Desktop button
                const button = document.createElement('button');
                button.className = 'team-filter-btn';
                button.setAttribute('data-team', team.slug);
                button.textContent = team.name;
                desktopButtons.appendChild(button);
            });
            
            console.log('‚úÖ Team filters loaded successfully from Netlify');
            
            // Trigger FixturesTimeline to re-setup filters now that buttons exist
            if (window.fixturesTimeline && typeof window.fixturesTimeline.setupTeamFilters === 'function') {
                console.log('üîÑ Re-initializing FixturesTimeline with new team buttons...');
                window.fixturesTimeline.setupTeamFilters();
            }
            
        } catch (error) {
            console.error('Error loading team filters:', error);
            
            // Fallback: add a basic "All Teams" option so page doesn't break
            const mobileSelect = document.getElementById('fixtures-team-select');
            const desktopButtons = document.getElementById('team-filter-buttons');
            
            if (mobileSelect && mobileSelect.children.length === 0) {
                mobileSelect.innerHTML = '<option value="all" selected>All Teams</option>';
            }
            
            if (desktopButtons && desktopButtons.children.length === 0) {
                const fallbackBtn = document.createElement('button');
                fallbackBtn.className = 'team-filter-btn active';
                fallbackBtn.setAttribute('data-team', 'all');
                fallbackBtn.textContent = 'All Teams';
                desktopButtons.appendChild(fallbackBtn);
            }
            
            console.log('‚ö†Ô∏è Using fallback: All Teams only');
        }
    }
    
    // Load team filters when page is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadTeamFilters);
    } else {
        loadTeamFilters();
    }
})();
</script>

<!-- ============================================ -->
<!-- ADMIN LOGIN MODAL (OLS 97) -->
<!-- ============================================ -->
<div id="adminLoginModal" class="modal" style="display: none;">
    <div class="modal-content" style="max-width: 400px;">
        <div class="modal-header">
            <h2>üîê Admin Login</h2>
            <span class="close" onclick="closeAdminLoginModal()">&times;</span>
        </div>
        <div class="modal-body">
            <form id="adminLoginForm" onsubmit="handleAdminLogin(event)">
                <div class="form-group">
                    <label for="adminEmail">Email Address</label>
                    <input 
                        type="email" 
                        id="adminEmail" 
                        name="adminEmail" 
                        required 
                        placeholder="your.email@example.com"
                        autocomplete="email"
                    >
                </div>
                
                <div class="form-group">
                    <label for="adminPassword">Password</label>
                    <input 
                        type="password" 
                        id="adminPassword" 
                        name="adminPassword" 
                        required 
                        placeholder="Enter your password"
                        autocomplete="current-password"
                    >
                </div>
                
                <div id="loginError" class="error-message" style="display: none; color: #d32f2f; margin-bottom: 15px;"></div>
                
                <div class="form-actions">
                    <button type="button" class="btn-secondary" onclick="closeAdminLoginModal()">Cancel</button>
                    <button type="submit" class="btn-primary" id="loginButton">
                        <span id="loginButtonText">Login</span>
                        <span id="loginSpinner" style="display: none;">‚è≥ Logging in...</span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<style>
/* Admin Login Modal Styles (OLS 98 - Updated to match footer.js) */
/* Highly specific selectors to avoid conflicts with existing page styles */

#adminLoginModal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.6);
    z-index: 10000;
    justify-content: center;
    align-items: center;
}

#adminLoginModal.modal {
    display: none;
}

#adminLoginModal .modal-content {
    max-width: 400px;
    background: var(--white, #ffffff);
    border-radius: 8px;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    width: 90%;
}

#adminLoginModal .modal-header {
    padding: 20px;
    border-bottom: 1px solid #e0e0e0;
    display: flex;
    justify-content: space-between;
    align-items: center;
    background: linear-gradient(135deg, var(--primary-green), var(--primary-maroon));
    color: var(--white, #ffffff);
    border-radius: 8px 8px 0 0;
}

#adminLoginModal .modal-header h2 {
    margin: 0;
    font-size: 1.25rem;
    color: var(--white, #ffffff);
}

#adminLoginModal .modal-header .close {
    background: transparent;
    border: none;
    color: var(--white, #ffffff);
    font-size: 28px;
    cursor: pointer;
    padding: 0;
    width: 30px;
    height: 30px;
    display: flex;
    align-items: center;
    justify-content: center;
}

#adminLoginModal .modal-header .close:hover {
    opacity: 0.7;
}

#adminLoginModal .modal-body {
    padding: 25px;
}

#adminLoginModal .form-group {
    margin-bottom: 20px;
}

#adminLoginModal .form-group label {
    display: block;
    margin-bottom: 8px;
    font-weight: 600;
    color: var(--text-dark, #333);
    font-size: 14px;
}

#adminLoginModal .form-group input {
    width: 100%;
    padding: 12px;
    border: 1px solid #ddd;
    border-radius: 4px;
    font-size: 14px;
    box-sizing: border-box;
    font-family: inherit;
}

#adminLoginModal .form-group input:focus {
    outline: none;
    border-color: var(--primary-green);
    box-shadow: 0 0 0 3px rgba(var(--primary-green-rgb), 0.1);
}

#adminLoginModal .form-actions {
    display: flex;
    gap: 10px;
    justify-content: flex-end;
    margin-top: 25px;
}

#adminLoginModal .btn-secondary {
    padding: 10px 20px;
    background: var(--bg-light, #f5f5f5);
    border: 1px solid #ddd;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    font-family: inherit;
    color: var(--text-dark, #333);
}

#adminLoginModal .btn-secondary:hover {
    background: #e0e0e0;
}

#adminLoginModal .btn-primary {
    padding: 10px 25px;
    background: var(--primary-green);
    color: var(--white, #ffffff);
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 14px;
    font-weight: 600;
    font-family: inherit;
}

#adminLoginModal .btn-primary:hover {
    background: var(--primary-maroon);
}

#adminLoginModal .btn-primary:disabled {
    background: #ccc;
    cursor: not-allowed;
}

#adminLoginModal .error-message {
    padding: 10px;
    background: #ffebee;
    border: 1px solid #ef5350;
    border-radius: 4px;
    font-size: 14px;
    color: #d32f2f;
}
</style>

<script>
/**
 * ADMIN LOGIN FUNCTIONS (OLS 97)
 * These override/extend the toggleAdminDashboard from footer.js
 */

// Override toggleAdminDashboard to open modal instead of prompt
function toggleAdminDashboard(event) {
    // Save current scroll position
    const scrollPosition = window.pageYOffset || document.documentElement.scrollTop;
    
    // Prevent page jump when clicking the link
    if (event && event.preventDefault) {
        event.preventDefault();
    }
    
    openAdminLoginModal();
    
    // Restore scroll position immediately
    setTimeout(() => {
        window.scrollTo(0, scrollPosition);
    }, 0);
    
    return false; // Extra safety to prevent default behavior
}

// Open the login modal
function openAdminLoginModal(event) {
    // Prevent page jump if called from a link
    if (event && event.preventDefault) {
        event.preventDefault();
    }
    document.getElementById('adminLoginModal').style.display = 'flex';
    document.getElementById('adminEmail').focus();
    return false;
}

// Close the login modal
function closeAdminLoginModal() {
    document.getElementById('adminLoginModal').style.display = 'none';
    document.getElementById('adminLoginForm').reset();
    document.getElementById('loginError').style.display = 'none';
}

// Handle admin login form submission
async function handleAdminLogin(event) {
    event.preventDefault();
    
    const email = document.getElementById('adminEmail').value.trim();
    const password = document.getElementById('adminPassword').value;
    const loginButton = document.getElementById('loginButton');
    const loginButtonText = document.getElementById('loginButtonText');
    const loginSpinner = document.getElementById('loginSpinner');
    const errorDiv = document.getElementById('loginError');
    
    // Clear previous errors
    errorDiv.style.display = 'none';
    
    // Show loading state
    loginButton.disabled = true;
    loginButtonText.style.display = 'none';
    loginSpinner.style.display = 'inline';
    
    try {
        // Check if the data manager class is loaded
        if (typeof OLRFCNetlifyDataManager === 'undefined') {
            throw new Error('System not ready. Please refresh the page and try again.');
        }
        
        // Initialize netlifyDataManager if not already done
        if (typeof window.netlifyDataManager === 'undefined') {
            window.netlifyDataManager = new OLRFCNetlifyDataManager();
        }
        
        // Attempt login via serverless function
        const result = await window.netlifyDataManager.loginAdminUser(email, password);
        
        if (result.success && result.user) {
            // Create enhanced session with full user data
            const adminSession = {
                userId: result.user.id,
                username: result.user.username,
                email: result.user.email,
                role: result.user.role,
                permissions: result.user.permissions,
                loginTime: new Date().getTime(),
                expiresAt: new Date().getTime() + (24 * 60 * 60 * 1000) // 24 hours
            };
            
            localStorage.setItem('olrfc_admin_session', JSON.stringify(adminSession));
            
            console.log('‚úÖ Login successful:', result.user.username);
            
            // Redirect to admin dashboard
            window.location.href = 'pages/admin-dashboard.html';
        } else {
            throw new Error('Login failed - invalid response');
        }
    } catch (error) {
        console.error('Login error:', error);
        
        // Show error message
        errorDiv.textContent = error.message || 'Invalid email or password. Please try again.';
        errorDiv.style.display = 'block';
        
        // Reset button
        loginButton.disabled = false;
        loginButtonText.style.display = 'inline';
        loginSpinner.style.display = 'none';
        
        // Clear password field
        document.getElementById('adminPassword').value = '';
        document.getElementById('adminPassword').focus();
    }
}

// Close modal when clicking outside
window.addEventListener('click', function(event) {
    const modal = document.getElementById('adminLoginModal');
    if (event.target === modal) {
        closeAdminLoginModal();
    }
});

// Handle escape key
window.addEventListener('keydown', function(event) {
    if (event.key === 'Escape') {
        const modal = document.getElementById('adminLoginModal');
        if (modal.style.display === 'flex') {
            closeAdminLoginModal();
        }
    }
});
</script>

</body>
</html>